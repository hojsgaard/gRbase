<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Graphs with the gRbase package • gRbase</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Graphs with the gRbase package">
<meta property="og:description" content="gRbase">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gRbase</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/arrays.html">Array operations with the gRbase package</a>
    </li>
    <li>
      <a href="../articles/graphs.html">Graphs with the gRbase package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Graphs with the gRbase package</h1>
                        <h4 data-toc-skip class="author">Søren
Højsgaard</h4>
            
      
      
      <div class="hidden name"><code>graphs.rmd</code></div>

    </div>

    
    
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'igraph'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     decompose, spectrum</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     union</span></span></code></pre>
<div class="section level2">
<h2 id="graphs-and-conditional-independence">Graphs and Conditional Independence<a class="anchor" aria-label="anchor" href="#graphs-and-conditional-independence"></a>
</h2>
<p>(#chap:graph)</p>
<p></p>
<ul>
<li><p>As a consequence, this document provides an up-to-date version of
Chapter 1 in the book Graphical Models with R (2012); hereafter
abbreviated GMwR, see <span class="citation">@hojsgaard:etal:12</span>.</p></li>
<li><p>This document also reflects that since GMwR was published in
2012, some packages that are mentioned in GMwR are no longer on CRAN.
This includes the packages <code>lcd</code> and
<code>sna</code>.</p></li>
<li><p>In this document it has been emphasized if a function has been
imported from <code>igraph</code> or if it is native function from
<code>gRbase</code> by writing <code>igraph::this\_function()</code> and
<code>gRbase::this\_function()</code></p></li>
<li><p>One notable feature that is not available in this version of
<code>gRbase</code> are functions related to maximal prime subgraph
decomposition. They may be reimplented at a later stage.</p></li>
</ul>
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>(#sec:<a href="graph:intro" class="uri">graph:intro</a>)</p>
<p>A graph as a <em>mathematical</em> object may be defined as a pair
<span class="math inline">\(\cal G = (V, E)\)</span>, where <span class="math inline">\(V\)</span> is a set of <em>vertices</em> or
<em>nodes</em> and <span class="math inline">\(E\)</span> is a set of
<em>edges</em>. Each edge is associated with a pair of nodes, its
<em>endpoints</em>. Edges may in general be directed, undirected, or
bidirected. Graphs are typically visualized by representing nodes by
circles or points, and edges by lines, arrows, or bidirected arrows. We
use the notation <span class="math inline">\(\alpha-\beta\)</span>,
<span class="math inline">\(\alpha\to\beta\)</span>, and <span class="math inline">\(\alpha\leftrightarrow\beta\)</span> to denote
edges between <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. Graphs are useful in a variety of
applications, and a number of packages for working with graphs are
available in .</p>
<p>In statistical applications we are particularly interested in two
special graph types: undirected graphs and directed acyclic graphs
(often called DAGs).</p>
<!-- % We have found the \igraph\ package to be useful. \igraph\ supports both undirected and -->
<!-- % directed graphs and implements various graph algorithms.  -->
<!-- % Functions in the package allow graphs to be displayed in a variety of formats. -->
<p>The  package supplements  by implementing some algorithms useful in
graphical modelling.  also provides two wrapper functions,
<code><a href="../reference/graph-create.html">ug()</a></code> and <code><a href="../reference/graph-create.html">dag()</a></code> for easily creating undirected
graphs and DAGs represented either as <code>igraph</code> objects or
adjacency matrices.</p>
<!-- \index{adjacency matrix} -->
<p>The first sections of this chapter describe some of the most useful
functions available when working with graphical models. These come
variously from the  and , but it is not usually necessary to know
which.</p>
<p>As <em>statistical</em> objects, graphs are used to represent models,
with nodes representing model variables (and sometimes model parameters)
in such a way that the independence structure of the model can be read
directly off the graph. Accordingly, a section of this chapter is
devoted to a brief description of the key concept of conditional
independence and explains how this is linked to graphs. Throughout the
book we shall repeatedly return to this in more detail.</p>
</div>
<div class="section level3">
<h3 id="graphs">Graphs<a class="anchor" aria-label="anchor" href="#graphs"></a>
</h3>
<p>Our graphs have a finite node set <span class="math inline">\(V\)</span> and for the most part they are
<em>simple graphs</em> in the sense that they have no loops nor multiple
edges. Two vertices <span class="math inline">\(\alpha\)</span> and
<span class="math inline">\(\beta\)</span> are said to be
<em>adjacent</em>, written <span class="math inline">\(\alpha\sim
\beta\)</span>, if there is an edge between <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> in <span class="math inline">\(\cal
G\)</span>, i.e. if either <span class="math inline">\(\alpha -
\beta\)</span>, <span class="math inline">\(\alpha\to\beta\)</span>, or
<span class="math inline">\(\alpha\leftrightarrow\beta\)</span>.</p>
<p> </p>
<p>In this chapter we primarily represent graphs as <code>igraph</code>
objects, and except where stated otherwise, the functions we describe
operate on these objects.</p>
<div class="section level4">
<h4 id="undirected-graphs">Undirected Graphs<a class="anchor" aria-label="anchor" href="#undirected-graphs"></a>
</h4>
<p>{#sec:<a href="graph:UG" class="uri">graph:UG</a>}</p>
<!-- An undirected graph may be created using the \comics{ug()}{gRbase}  function. The -->
<!-- graph can be specified using a list of formulas, a single formula or a -->
<!-- list of vectors.  -->
<p>The following forms are equivalent:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://people.math.aau.dk/~sorenh/software/gR/" class="external-link">gRbase</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'gRbase'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:igraph':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     edges, is_dag, topo_sort</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ug0</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-create.html">ug</a></span><span class="op">(</span><span class="op">~</span><span class="va">a</span><span class="op">:</span><span class="va">b</span>, <span class="op">~</span><span class="va">b</span><span class="op">:</span><span class="va">c</span><span class="op">:</span><span class="va">d</span>, <span class="op">~</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="va">ug0</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-create.html">ug</a></span><span class="op">(</span><span class="op">~</span><span class="va">a</span><span class="op">:</span><span class="va">b</span> <span class="op">+</span> <span class="va">b</span><span class="op">:</span><span class="va">c</span><span class="op">:</span><span class="va">d</span> <span class="op">+</span> <span class="va">e</span><span class="op">)</span></span>
<span><span class="va">ug0</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-create.html">ug</a></span><span class="op">(</span><span class="op">~</span><span class="va">a</span><span class="op">*</span><span class="va">b</span> <span class="op">+</span> <span class="va">b</span><span class="op">*</span><span class="va">c</span><span class="op">*</span><span class="va">d</span> <span class="op">+</span> <span class="va">e</span><span class="op">)</span></span>
<span><span class="va">ug0</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-create.html">ug</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span><span class="op">)</span>, <span class="st">"e"</span><span class="op">)</span></span>
<span><span class="va">ug0</span></span></code></pre></div>
<pre><code><span><span class="co">## IGRAPH 0325f2d UN-- 5 4 -- </span></span>
<span><span class="co">## + attr: name (v/c)</span></span>
<span><span class="co">## + edges from 0325f2d (vertex names):</span></span>
<span><span class="co">## [1] a--b b--c b--d c--d</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/GRAPHunnamed-chunk-4-1.png" width="700"></p>
<p>The default size of vertices and their labels is quite small. This is
easily changed by setting certain attributes on the graph, see
Sect.~@ref(sec:<a href="graph:igraph" class="uri">graph:igraph</a>) for
examples. However, to avoid changing these attributes for all the graphs
shown in the following we have defined a small plot function . There are
also various facilities for controlling the layout. For example, we may
use a layout algorithm called <code>layout.fruchterman.reingold</code>
as follows:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myplot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">layout</span><span class="op">=</span><span class="fu"><a href="https://r.igraph.org/reference/layout.deprecated.html" class="external-link">layout.fruchterman.reingold</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span>  <span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">label.cex</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, layout<span class="op">=</span><span class="va">layout</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The graph <code>ug0i</code> is then displayed with:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">myplot</span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/GRAPHunnamed-chunk-6-1.png" width="700"></p>
<p>Per default the function returns an <code>igraph</code> object, but
the option <code>result="matrix"</code> lead it to return an adjacency
matrix instead. For example,</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ug0i</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-create.html">ug</a></span><span class="op">(</span><span class="op">~</span><span class="va">a</span><span class="op">:</span><span class="va">b</span> <span class="op">+</span> <span class="va">b</span><span class="op">:</span><span class="va">c</span><span class="op">:</span><span class="va">d</span> <span class="op">+</span> <span class="va">e</span>, result<span class="op">=</span><span class="st">"matrix"</span><span class="op">)</span></span>
<span><span class="va">ug0i</span></span></code></pre></div>
<pre><code><span><span class="co">##   a b c d e</span></span>
<span><span class="co">## a 0 1 0 0 0</span></span>
<span><span class="co">## b 1 0 1 1 0</span></span>
<span><span class="co">## c 0 1 0 1 0</span></span>
<span><span class="co">## d 0 1 1 0 0</span></span>
<span><span class="co">## e 0 0 0 0 0</span></span></code></pre>
<p>Different represents of a graph can be obtained by coercion:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">ug0</span>, <span class="st">"matrix"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   a b c d e</span></span>
<span><span class="co">## a 0 1 0 0 0</span></span>
<span><span class="co">## b 1 0 1 1 0</span></span>
<span><span class="co">## c 0 1 0 1 0</span></span>
<span><span class="co">## d 0 1 1 0 0</span></span>
<span><span class="co">## e 0 0 0 0 0</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">ug0</span>, <span class="st">"dgCMatrix"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 5 x 5 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">##   a b c d e</span></span>
<span><span class="co">## a . 1 . . .</span></span>
<span><span class="co">## b 1 . 1 1 .</span></span>
<span><span class="co">## c . 1 . 1 .</span></span>
<span><span class="co">## d . 1 1 . .</span></span>
<span><span class="co">## e . . . . .</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">ug0i</span>, <span class="st">"igraph"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## IGRAPH 10542e8 UN-- 5 4 -- </span></span>
<span><span class="co">## + attr: name (v/c), label (v/c)</span></span>
<span><span class="co">## + edges from 10542e8 (vertex names):</span></span>
<span><span class="co">## [1] a--b b--c b--d c--d</span></span></code></pre>
<p>Edges can be added and deleted using <code><a href="../reference/graph_query.html">addEdge()</a></code> and
<code><a href="../reference/graph_query.html">removeEdge()</a></code></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Using gRbase</span></span>
<span><span class="va">ug0a</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">addEdge</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"c"</span>, <span class="va">ug0</span><span class="op">)</span></span>
<span><span class="va">ug0a</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">removeEdge</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"d"</span>, <span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Using igraph</span></span>
<span><span class="va">ug0a</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/add_edges.html" class="external-link">add_edges</a></span><span class="op">(</span><span class="va">ug0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ug0a</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/delete_edges.html" class="external-link">delete_edges</a></span><span class="op">(</span><span class="va">ug0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c|d"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The nodes and edges of a graph can be retrieved with and
functions.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Using gRbase</span></span>
<span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">nodes</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span>           </span></code></pre></div>
<pre><code><span><span class="co">## [1] "a" "b" "c" "d" "e"</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">edges</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 5</span></span>
<span><span class="co">##  $ a: chr "b"</span></span>
<span><span class="co">##  $ b: chr [1:3] "a" "c" "d"</span></span>
<span><span class="co">##  $ c: chr [1:2] "b" "d"</span></span>
<span><span class="co">##  $ d: chr [1:2] "b" "c"</span></span>
<span><span class="co">##  $ e: chr(0)</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Using igraph</span></span>
<span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## + 5/5 vertices, named, from 0325f2d:</span></span>
<span><span class="co">## [1] a b c d e</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="st">"names"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "a" "b" "c" "d" "e"</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## + 4/4 edges from 0325f2d (vertex names):</span></span>
<span><span class="co">## [1] a--b b--c b--d c--d</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="st">"vnames"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "a|b" "b|c" "b|d" "c|d"</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-clique.html">maxClique</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span> <span class="co">## |&gt; str() </span></span></code></pre></div>
<pre><code><span><span class="co">## $maxCliques</span></span>
<span><span class="co">## $maxCliques[[1]]</span></span>
<span><span class="co">## [1] "e"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $maxCliques[[2]]</span></span>
<span><span class="co">## [1] "a" "b"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $maxCliques[[3]]</span></span>
<span><span class="co">## [1] "b" "c" "d"</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-clique.html">get_cliques</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 3</span></span>
<span><span class="co">##  $ : chr "e"</span></span>
<span><span class="co">##  $ : chr [1:2] "a" "b"</span></span>
<span><span class="co">##  $ : chr [1:3] "b" "c" "d"</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Using igraph</span></span>
<span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/cliques.html" class="external-link">max_cliques</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"names"</span><span class="op">)</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 3</span></span>
<span><span class="co">##  $ : chr "e"</span></span>
<span><span class="co">##  $ : chr [1:2] "a" "b"</span></span>
<span><span class="co">##  $ : chr [1:3] "b" "c" "d"</span></span></code></pre>
<p>A <em>path</em> (of length <span class="math inline">\(n\)</span>)
between <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> in an undirected graph is a set of
vertices <span class="math inline">\(\alpha=\alpha_0,\alpha_1,\dots,\alpha_n=\beta\)</span>
where <span class="math inline">\(\alpha_{i-1}-\alpha_i\)</span> for
<span class="math inline">\(i=1,\dots, n\)</span>. If a path <span class="math inline">\(n\alpha=\alpha_0,\alpha_1,\dots,\alpha_n=\beta\)</span>
has <span class="math inline">\(\alpha=\beta\)</span> then the path is
said to be a <em>cycle</em> of length <span class="math inline">\(n\)</span>. nnn A subset <span class="math inline">\(D \subset V\)</span> in an undirected graph is
said to <em>separate</em> <span class="math inline">\(A \subset
V\)</span> from <span class="math inline">\(B \subset V\)</span> if
every path between a vertex in <span class="math inline">\(A\)</span>
and a vertex in <span class="math inline">\(B\)</span> contains a vertex
from <span class="math inline">\(D\)</span>.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">separates</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"d"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span>, <span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>This shows that <span class="math inline">\(\{b,c\}\)</span>
separates <span class="math inline">\(\{a\}\)</span> and <span class="math inline">\(\{d\}\)</span>.</p>
<p>The graph <span class="math inline">\(\cal G_0=(V_0,E_0)\)</span> is
said to be a <em>subgraph</em> of <span class="math inline">\(\cal
G=(V,E)\)</span> if <span class="math inline">\(V_0\subseteq V\)</span>
and <span class="math inline">\(E_0\subseteq E\)</span>. For <span class="math inline">\(A \subseteq V\)</span>, let <span class="math inline">\(E_A\)</span> denote the set of edges in <span class="math inline">\(E\)</span> between vertices in <span class="math inline">\(A\)</span>. Then <span class="math inline">\(\cal
G_A=(A, E_A)\)</span> is the <span class="math inline">\(A\)</span>. For
example</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ug1</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">subGraph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"e"</span><span class="op">)</span>, <span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ug12</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/subgraph.html" class="external-link">subgraph</a></span><span class="op">(</span><span class="va">ug0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"e"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">myplot</span><span class="op">(</span><span class="va">ug1</span><span class="op">)</span>; <span class="fu">myplot</span><span class="op">(</span><span class="va">ug12</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/GRAPHunnamed-chunk-17-1.png" width="700"></p>
<p> </p>
<p>The <em>boundary</em> <span class="math inline">\(\bound(\alpha)=\adj(\alpha)\)</span> is the set of
vertices adjacent to <span class="math inline">\(\alpha\)</span> and for
undirected graphs the boundary is equal to the set of
<em>neighbours</em> <span class="math inline">\(\nei(\alpha)\)</span>.
The <em>closure</em> <span class="math inline">\(\clos(\alpha)\)</span>
is <span class="math inline">\(\bound(\alpha)\cup
\{\alpha\}\)</span>.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">adj</a></span><span class="op">(</span><span class="va">ug0</span>, <span class="st">"c"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $c</span></span>
<span><span class="co">## [1] "b" "d"</span></span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">closure</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "c" "b" "d"</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="directed-acyclic-graphs">Directed Acyclic Graphs<a class="anchor" aria-label="anchor" href="#directed-acyclic-graphs"></a>
</h4>
<p>{#sec:<a href="graph:DAG" class="uri">graph:DAG</a>}</p>
<p>A <em>directed graph</em> as a mathematical object is a pair <span class="math inline">\(\cal G = (V, E)\)</span> where <span class="math inline">\(V\)</span> is a set of vertices and <span class="math inline">\(E\)</span> is a set of directed edges, normally
drawn as arrows. A directed graph is <em>acyclic</em> if it has no
directed cycles, that is, cycles with the arrows pointing in the same
direction all the way around. A <em>DAG</em> is a directed graph that is
acyclic.</p>
<!-- \index{directed graph} \index{directed edges} \index{directed acyclic graph} \index{DAG} -->
<p>A DAG may be created using the <code><a href="../reference/graph-create.html">dag()</a></code> function. The graph
can be specified by a list of formulas or by a list of vectors. The
following statements are equivalent:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dag0</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-create.html">dag</a></span><span class="op">(</span><span class="op">~</span><span class="va">a</span>, <span class="op">~</span><span class="va">b</span><span class="op">*</span><span class="va">a</span>,  <span class="op">~</span><span class="va">c</span><span class="op">*</span><span class="va">a</span><span class="op">*</span><span class="va">b</span>, <span class="op">~</span><span class="va">d</span><span class="op">*</span><span class="va">c</span><span class="op">*</span><span class="va">e</span>, <span class="op">~</span><span class="va">e</span><span class="op">*</span><span class="va">a</span>, <span class="op">~</span><span class="va">g</span><span class="op">*</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="va">dag0</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-create.html">dag</a></span><span class="op">(</span><span class="op">~</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span><span class="op">*</span><span class="va">a</span> <span class="op">+</span> <span class="va">c</span><span class="op">*</span><span class="va">a</span><span class="op">*</span><span class="va">b</span> <span class="op">+</span> <span class="va">d</span><span class="op">*</span><span class="va">c</span><span class="op">*</span><span class="va">e</span> <span class="op">+</span> <span class="va">e</span><span class="op">*</span><span class="va">a</span> <span class="op">+</span> <span class="va">g</span><span class="op">*</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="va">dag0</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-create.html">dag</a></span><span class="op">(</span><span class="op">~</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span><span class="op">|</span><span class="va">a</span> <span class="op">+</span> <span class="va">c</span><span class="op">|</span><span class="va">a</span><span class="op">*</span><span class="va">b</span> <span class="op">+</span> <span class="va">d</span><span class="op">|</span><span class="va">c</span><span class="op">*</span><span class="va">e</span> <span class="op">+</span> <span class="va">e</span><span class="op">|</span><span class="va">a</span> <span class="op">+</span> <span class="va">g</span><span class="op">|</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="va">dag0</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-create.html">dag</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"c"</span>, <span class="st">"e"</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"e"</span>, <span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"g"</span>, <span class="st">"f"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dag0</span></span></code></pre></div>
<pre><code><span><span class="co">## IGRAPH 5ffe96e DN-- 7 7 -- </span></span>
<span><span class="co">## + attr: name (v/c)</span></span>
<span><span class="co">## + edges from 5ffe96e (vertex names):</span></span>
<span><span class="co">## [1] a-&gt;b a-&gt;c b-&gt;c c-&gt;d e-&gt;d a-&gt;e f-&gt;g</span></span></code></pre>
<p>Note that <code>\~{ }a} means that \code{"a"</code> has no parents
while
<code>\~{ }d*b*c} means that</code>“d”<code>has parents \code{"b"</code>
and <code>"c"}. Instead of ``\code{*}'', a ``\code{:</code>’’ can be
used in the specification. If the specified graph contains cycles then
<code>dag()} returns \code{NULL</code>.</p>
<p>Per default the function returns an <code>igraph</code> object, but
the option <code>result="matrix"</code> leads it to return an adjacency
matrix instead.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">myplot</span><span class="op">(</span><span class="va">dag0</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/GRAPHunnamed-chunk-20-1.png" width="700"></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">nodes</a></span><span class="op">(</span><span class="va">dag0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "a" "b" "c" "d" "e" "f" "g"</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">edges</a></span><span class="op">(</span><span class="va">dag0</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 7</span></span>
<span><span class="co">##  $ a: chr [1:3] "b" "c" "e"</span></span>
<span><span class="co">##  $ b: chr "c"</span></span>
<span><span class="co">##  $ c: chr "d"</span></span>
<span><span class="co">##  $ d: chr(0) </span></span>
<span><span class="co">##  $ e: chr "d"</span></span>
<span><span class="co">##  $ f: chr "g"</span></span>
<span><span class="co">##  $ g: chr(0)</span></span></code></pre>
<p>Alternatively a list of (ordered) pairs can be optained with
edgeList()</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/graph-edgeList.html">edgeList</a></span><span class="op">(</span><span class="va">dag0</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 7</span></span>
<span><span class="co">##  $ : chr [1:2] "a" "b"</span></span>
<span><span class="co">##  $ : chr [1:2] "a" "c"</span></span>
<span><span class="co">##  $ : chr [1:2] "a" "e"</span></span>
<span><span class="co">##  $ : chr [1:2] "b" "c"</span></span>
<span><span class="co">##  $ : chr [1:2] "c" "d"</span></span>
<span><span class="co">##  $ : chr [1:2] "e" "d"</span></span>
<span><span class="co">##  $ : chr [1:2] "f" "g"</span></span></code></pre>
<p>The vpar() function returns a list, with an element for each node
together with its parents:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vpardag0</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_vpar.html">vpar</a></span><span class="op">(</span><span class="va">dag0</span><span class="op">)</span></span>
<span><span class="va">vpardag0</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 7</span></span>
<span><span class="co">##  $ a: chr "a"</span></span>
<span><span class="co">##  $ b: chr [1:2] "b" "a"</span></span>
<span><span class="co">##  $ c: chr [1:3] "c" "a" "b"</span></span>
<span><span class="co">##  $ d: chr [1:3] "d" "c" "e"</span></span>
<span><span class="co">##  $ e: chr [1:2] "e" "a"</span></span>
<span><span class="co">##  $ f: chr "f"</span></span>
<span><span class="co">##  $ g: chr [1:2] "g" "f"</span></span></code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vpardag0</span><span class="op">$</span><span class="va">c</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "c" "a" "b"</span></span></code></pre>
<p> </p>
<p>A <em>path</em> (of length <span class="math inline">\(n\)</span>)
from <span class="math inline">\(\alpha\)</span> to <span class="math inline">\(\beta\)</span> is a sequence of vertices <span class="math inline">\(\alpha=\alpha_0, \dots, \alpha_n=\beta\)</span>
such that <span class="math inline">\(\alpha_{i-1}\to\alpha_i\)</span>
is an edge in the graph. If there is a path from <span class="math inline">\(\alpha\)</span> to <span class="math inline">\(\beta\)</span> we write <span class="math inline">\(\alpha\mapsto\beta\)</span>. The <em>parents</em>
<span class="math inline">\(\parents(\beta)\)</span> of a node <span class="math inline">\(\beta\)</span> are those nodes <span class="math inline">\(\alpha\)</span> for which <span class="math inline">\(\alpha \rightarrow \beta\)</span>. The
<em>children</em> <span class="math inline">\(\child(\alpha)\)</span> of
a node <span class="math inline">\(\alpha\)</span> are those nodes <span class="math inline">\(\beta\)</span> for which <span class="math inline">\(\alpha \rightarrow \beta\)</span>. The
<em>ancestors</em> <span class="math inline">\(\anc(\beta)\)</span> of a
node <span class="math inline">\(\beta\)</span> are the nodes <span class="math inline">\(\alpha\)</span> such that <span class="math inline">\(\alpha\mapsto\beta\)</span>. The <em>ancestral
set</em> <span class="math inline">\(\anc(A)\)</span> of a set <span class="math inline">\(A\)</span> is the union of <span class="math inline">\(A\)</span> with its ancestors. The <em>ancestral
graph</em> of a set <span class="math inline">\(A\)</span> is the
subgraph induced by the ancestral set of <span class="math inline">\(A\)</span>.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">parents</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="va">dag0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "c" "e"</span></span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">children</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="va">dag0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "d"</span></span></code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">ancestralSet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"e"</span><span class="op">)</span>, <span class="va">dag0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "a" "b" "e"</span></span></code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ag</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">ancestralGraph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"e"</span><span class="op">)</span>, <span class="va">dag0</span><span class="op">)</span></span>
<span><span class="fu">myplot</span><span class="op">(</span><span class="va">ag</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/GRAPHunnamed-chunk-24-1.png" width="700"></p>
<p></p>
<p>An important operation on DAGs is to (i) add edges between the
parents of each node, and then (ii) replace all directed edges with
undirected ones, thus returning an undirected graph. This operation is
used in connection with independence interpretations of the DAG, see
Sect.~@ref(sec:<a href="graph:CI" class="uri">graph:CI</a>), and is
known as <em>moralization</em>. This is implemented by the function:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dag0m</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-moralize.html">moralize</a></span><span class="op">(</span><span class="va">dag0</span><span class="op">)</span></span>
<span><span class="fu">myplot</span><span class="op">(</span><span class="va">dag0m</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/GRAPHunnamed-chunk-25-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="mixed-graphs">Mixed Graphs<a class="anchor" aria-label="anchor" href="#mixed-graphs"></a>
</h4>
<p>{#sec:<a href="graph:chaingraphs" class="uri">graph:chaingraphs</a>}
</p>
<p>Although the primary focus of this book is on undirected graphs and
DAGs, it is also useful to consider <em>mixed graphs</em>. These are
graphs with at least two types of edges, for example directed and
undirected, or directed and bidirected.</p>
<p>A sequence of vertices <span class="math inline">\(v_1,v_2, \dots
v_{k}, v_{k+1}\)</span> is called a <em>path</em> if for each <span class="math inline">\(i=1 \dots k\)</span>, either <span class="math inline">\(v_i - v_{i+1}\)</span>, <span class="math inline">\(v_i \leftrightarrow v_{i+1}\)</span> or <span class="math inline">\(v_i \rightarrow v_{i+1}\)</span>. If <span class="math inline">\(v_i - v_{i+1}\)</span> for each <span class="math inline">\(i\)</span> the path is called <em>undirected</em>,
if <span class="math inline">\(v_i \rightarrow v_{i+1}\)</span> for each
<span class="math inline">\(i\)</span> it is called <em>directed</em>,
and if <span class="math inline">\(v_i \rightarrow v_{i+1}\)</span> for
at least one <span class="math inline">\(i\)</span> it is called
<em>semi-directed</em>. If <span class="math inline">\(v_i =
v_{k+1}\)</span> it is called a <em>cycle</em>.</p>
<p> </p>
<p>Mixed graphs are represented in the  package as directed graphs with
multiple edges. In this sense they are not simple. A convenient way of
defining them (in lieu of model formulae) is to use adjacency matrices.
We can construct such a matrix as follows:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adjm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>                 <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>                 <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>                 <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, byrow<span class="op">=</span><span class="cn">TRUE</span>, nrow<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">adjm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">adjm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">adjm</span></span></code></pre></div>
<pre><code><span><span class="co">##   a b c d</span></span>
<span><span class="co">## a 0 1 1 1</span></span>
<span><span class="co">## b 1 0 0 1</span></span>
<span><span class="co">## c 1 0 0 1</span></span>
<span><span class="co">## d 0 1 0 0</span></span></code></pre>
<p>Note that <code>igraph</code> interprets symmetric entries as
double-headed arrows and thus does not distinguish between bidirected
and undirected edges. However we can persuade <code>igraph</code> to
display undirected instead of bidirected edges:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gG1</span> <span class="op">&lt;-</span> <span class="va">gG2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">adjm</span>, <span class="st">"igraph"</span><span class="op">)</span></span>
<span><span class="va">lay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/layout.deprecated.html" class="external-link">layout.fruchterman.reingold</a></span><span class="op">(</span><span class="va">gG1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">gG2</span><span class="op">)</span><span class="op">$</span><span class="va">arrow.mode</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://r.igraph.org/reference/is.mutual.html" class="external-link">is.mutual</a></span><span class="op">(</span><span class="va">gG2</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: `is.mutual()` was deprecated in igraph 2.0.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `which_mutual()` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">myplot</span><span class="op">(</span><span class="va">gG1</span>, layout<span class="op">=</span><span class="va">lay</span><span class="op">)</span>; <span class="fu">myplot</span><span class="op">(</span><span class="va">gG2</span>, layout<span class="op">=</span><span class="va">lay</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/GRAPHunnamed-chunk-28-1.png" width="700"></p>
<p></p>
<p>A <em>chain graph</em> is a mixed graph with no bidirected edges and
no semi-directed cycles. Such graphs form a natural generalisation of
undirected graphs and DAGs, as we shall see later. The following example
is from <span class="citation">@Frydenberg1990</span>:</p>
<p> %sæt figurstørrelse i Sweave</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">11</span>, <span class="fl">11</span><span class="op">)</span></span>
<span><span class="va">d1</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">d1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">d1</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">d1</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">d1</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">d1</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">d1</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">d1</span><span class="op">[</span><span class="fl">6</span>,<span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">d1</span><span class="op">[</span><span class="fl">9</span>,<span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">d1</span><span class="op">[</span><span class="fl">10</span>,<span class="fl">9</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">d1</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">8</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">d1</span><span class="op">[</span><span class="fl">8</span>,<span class="fl">7</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">d1</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">d1</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">d1</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">d1</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">7</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">d1</span><span class="op">[</span><span class="fl">6</span>,<span class="fl">11</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">d1</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">11</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span></span>
<span><span class="va">cG1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">d1</span>, <span class="st">"igraph"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">cG1</span><span class="op">)</span><span class="op">$</span><span class="va">arrow.mode</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://r.igraph.org/reference/is.mutual.html" class="external-link">is.mutual</a></span><span class="op">(</span><span class="va">cG1</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">myplot</span><span class="op">(</span><span class="va">cG1</span>, layout<span class="op">=</span><span class="va">layout.fruchterman.reingold</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/GRAPHunnamed-chunk-29-1.png" width="700"></p>
<p> %sæt figurstørrelse i Sweave </p>
<p>The <em>components</em> of a chain graph <span class="math inline">\(\cal G\)</span> are the connected components of
the graph formed after removing all directed edges from <span class="math inline">\(\cal G\)</span>. All edges within a component are
undirected, and all edges between components are directed. Also, all
arrows between any two components have the same direction. The graph
constructed by identifying its nodes with the components of <span class="math inline">\(\cal G\)</span>, and joining two nodes with an
arrow whenever there is an arrow between the corresponding components in
<span class="math inline">\(\cal G\)</span>, is a DAG, the so-called
<em>component DAG</em> of <span class="math inline">\(\cal G\)</span>,
written <span class="math inline">\(\cal G_{C}\)</span>.</p>
<p>% The function in the  package % determines whether a mixed graph is
a chain graph. It takes an % adjacency matrix as input. For example, the
above graph is indeed a % chain graph:</p>
<p>% ```{r eval=F} % library(lcd) % is.chaingraph(as(cG1, “matrix”)) %
@</p>
<p>% Here <code>vert.order</code> gives an ordering of the vertices,
from which the % connected components may be identified using
<code>chain.size</code>.</p>
<p> </p>
<p>The <em>anterior set</em> of a vertex set <span class="math inline">\(S \subseteq V\)</span> is defined in terms of the
component DAG. Write the set of components of <span class="math inline">\(\cal G\)</span> containing <span class="math inline">\(S\)</span> as <span class="math inline">\(S_c\)</span>. Then the anterior set of <span class="math inline">\(S\)</span> in <span class="math inline">\(\cal
G\)</span> is defined as the union of the components in the ancestral
set of <span class="math inline">\(S_c\)</span> in <span class="math inline">\(\cal G_{C}\)</span>. The <em>anterior graph</em>
of <span class="math inline">\(S \subseteq V\)</span> is the subgraph of
<span class="math inline">\(\cal G\)</span> induced by the anterior set
of <span class="math inline">\(S\)</span>.</p>
<p>The <em>moralization</em> operation is also important for chain
graphs. Similar to DAGs, unmarried parents of the same chain components
are joined and directions are then removed.</p>
<p>% The operation % is implemented in the function in the %  package,
which uses the adjacency matrix representation. For % example,</p>
<p>% ```{r , eval=F} % ## cGm &lt;- as(moralize(as(cG1, “matrix”)),
“graphNEL”) % cGm &lt;- moralize(cG1) % plot(cGm) % @</p>
<p>% ```{r echo=F, eval=F} % detach(package:lcd) % @</p>
</div>
</div>
<div class="section level3">
<h3 id="conditional-independence-and-graphs">Conditional Independence and Graphs<a class="anchor" aria-label="anchor" href="#conditional-independence-and-graphs"></a>
</h3>
<p>{#sec:<a href="graph:CI" class="uri">graph:CI</a>} </p>
<p>The concept of statistical independence is presumably familiar to all
readers but that of <em>conditional independence</em> may be less so.
Suppose that we have a collection of random variables <span class="math inline">\((X_v)_{v \in V}\)</span> with a joint density. Let
<span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span> be subsets of <span class="math inline">\(V\)</span> and let <span class="math inline">\(X_A=(X_v)_{v \in A}\)</span> and similarly for
<span class="math inline">\(X_B\)</span> and <span class="math inline">\(X_C\)</span>. Then the statement that <span class="math inline">\(X_A\)</span> and <span class="math inline">\(X_B\)</span> are conditionally independent given
<span class="math inline">\(X_C\)</span>, written <span class="math inline">\(A \cip B \cd C\)</span>, means that for each
possible value of <span class="math inline">\(x_C\)</span> of <span class="math inline">\(X_C\)</span>, <span class="math inline">\(X_A\)</span> and <span class="math inline">\(X_B\)</span> are independent in the conditional
distribution given <span class="math inline">\(X_C=x_c\)</span>. So if
we write <span class="math inline">\(f()\)</span> for a generic density
or probability mass function, then one characterization of <span class="math inline">\(A \cip B \cd C\)</span> is that <span class="math display">\[
f(x_A,x_B \cd x_C) = f(x_A \cd x_C) f(x_B \cd x_C).
\]</span> An equivalent characterization <span class="citation">[@Dawid1998]</span> is that the joint density of <span class="math inline">\((X_A, X_B, X_C)\)</span> factorizes as <span class="math display">\[\begin{equation}
f(x_A,x_B,x_C) = g(x_A,x_C)h(x_B,x_C),
{#eqn:graph:factcrit}
\end{equation}\]</span> that is, as a product of two functions <span class="math inline">\(g()\)</span> and <span class="math inline">\(h()\)</span>, where <span class="math inline">\(g()\)</span> does not depend on <span class="math inline">\(x_B\)</span> and <span class="math inline">\(h()\)</span> does not depend on <span class="math inline">\(x_A\)</span>. This is known as the
<em>factorization criterion</em>.</p>
<p></p>
<p>Parametric models for <span class="math inline">\((X_v)_{v \in
V}\)</span> may be thought of as specifying a set of joint densities
(one for each admissible set of parameters). These may admit
factorisations of the form just described, giving rise to conditional
independence relations between the variables. Some models give rise to
patterns of conditional independences that can be represented as an
undirected graph. More specifically, let <span class="math inline">\(\cal G=(V,E)\)</span> be an undirected graph with
cliques <span class="math inline">\(C_1, \dots C_k\)</span>. Consider a
joint density <span class="math inline">\(f()\)</span> of the variables
in <span class="math inline">\(V\)</span>. If this admits a
factorization of the form <span class="math display">\[
f(x_V) = \prod_{i=1}^k g_i(x_{C_i})
\]</span><br>
for some functions <span class="math inline">\(g_1() \dots
g_k()\)</span> where <span class="math inline">\(g_j()\)</span> depends
on <span class="math inline">\(x\)</span> only through <span class="math inline">\(x_{C_j}\)</span> then we say that <span class="math inline">\(f()\)</span> factorizes according to <span class="math inline">\(\cal G\)</span>.</p>
<p></p>
<p>If all the densities under a model factorize according to <span class="math inline">\(\cal G\)</span>, then <span class="math inline">\(\cal G\)</span> encodes the conditional
independence structure of the model, through the following result (the
<em>global Markov property</em>): whenever sets <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are separated by a set <span class="math inline">\(C\)</span> in the graph, then <span class="math inline">\(A \cip B \cd C\)</span> under the model.<br>
Thus for example</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">myplot</span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/GRAPHunnamed-chunk-30-1.png" width="700"></p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">separates</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"d"</span>, <span class="st">"b"</span>, <span class="va">ug0</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>shows that under a model with this dependence graph, <span class="math inline">\(a \cip d \cd b\)</span>.</p>
<p>If we want to find out whether two variable sets are marginally
independent, we ask whether they are separated by the empty set, which
we specify using a character vector of length zero:</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">separates</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"d"</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<p>Model families that admit suitable factorizations are described in
later chapters in this book. These include: log-linear models for
multivariate discrete data, graphical Gaussian models for multivariate
Gaussian data, and mixed interaction models for mixed discrete and
continuous data.</p>
<p>Other models give rise to patterns of conditional independences that
can be represented by DAGs. These are models for which the variable set
<span class="math inline">\(V\)</span> may be ordered in such way that
the joint density factorizes as follows <span class="math display">\[\begin{equation}
  {#eq:graph:dagfact}
f(x_V) = \prod_{v \in V} f(x_v \cd x_{\parents(v)})  
\end{equation}\]</span> for some variable sets <span class="math inline">\(\{\parents(v)\}_{v \in V}\)</span> such that the
variables in <span class="math inline">\(\parents(v)\)</span> precede
<span class="math inline">\(v\)</span> in the ordering. Again the
vertices of the graph represent the random variables, and we can
identify the sets <span class="math inline">\(\parents(v)\)</span> with
the parents of <span class="math inline">\(v\)</span> in the DAG.</p>
<p></p>
<p>With DAGs, conditional independence is represented by a property
called <em>d-separation</em>. That is, whenever sets <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are <span class="math inline">\(d\)</span>-separated by a set <span class="math inline">\(C\)</span> in the graph, then <span class="math inline">\(A \cip B \cd C\)</span> under the model. The
notion of <span class="math inline">\(d\)</span>-separation can be
defined in various ways, but one characterisation is as follows: <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are <span class="math inline">\(d\)</span>-separated by a set <span class="math inline">\(C\)</span> if and only if they are separated in
the graph formed by moralizing the anterior graph of <span class="math inline">\(A \cup B \cup C\)</span>.</p>
<p>So we can easily define a function to test this:</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_separates</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">c</span>, <span class="va">dag_</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co">##ag &lt;- ancestralGraph(union(union(a, b), c), dag_)</span></span>
<span>    <span class="va">ag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_query.html">ancestralGraph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">c</span><span class="op">)</span>, <span class="va">dag_</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/graph_query.html">separates</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">c</span>, <span class="fu"><a href="../reference/graph-moralize.html">moralize</a></span><span class="op">(</span><span class="va">ag</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">d_separates</span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"e"</span>, <span class="st">"a"</span>, <span class="va">dag0</span><span class="op">)</span>    </span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>So under <code>dag0</code> it holds that <span class="math inline">\(c \cip e \cd a\)</span>.</p>
<p>% Alternatively, we can use the function in the  package:</p>
<p>% ```{r } % library(ggm) % dSep(as(dag0, “matrix”), “c”, “e”, “a”) %
@</p>
<p>% ```{r echo=F} % detach(package:ggm) % @</p>
<p>Still other models correspond to patterns of conditional
independences that can be represented by a chain graph <span class="math inline">\(\cal G\)</span>. There are several ways to relate
Markov properties to chain graphs. Here we describe the so-called LWF
Markov properties, associated with Lauritzen, Wermuth and
Frydenberg.</p>
<p>For these there are two levels to the factorization requirements.
Firstly, the joint density needs to factorize in a way similar to a DAG,
i.e. <span class="math display">\[
f(x_V) = \prod_{C \in \calC} f(x_C \cd x_{\parents(C)})
\]</span><br>
where <span class="math inline">\(\calC\)</span> is the set of
components of <span class="math inline">\(\cal G\)</span>. In addition,
each conditional density <span class="math inline">\(f(x_C \cd
x_{\parents(C)})\)</span> must factorize according to an undirected
graph constructed in the following way. First form the subgraph of <span class="math inline">\(\cal G\)</span> induced by <span class="math inline">\(C \cup \parents(C)\)</span>, drop directions, and
then complete <span class="math inline">\(\parents(C)\)</span> (that is,
add edges between all vertices in <span class="math inline">\(\parents(C))\)</span>).</p>
<p></p>
<p>For densities which factorize as above, conditional independence is
related to a property called <em>c-separation</em>: that is, <span class="math inline">\(A \cip B \cd C\)</span> whenever sets <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are <span class="math inline">\(c\)</span>-separated by <span class="math inline">\(C\)</span> in the graph. The notion of <span class="math inline">\(c\)</span>-separation in chain graphs is similar
to that of <span class="math inline">\(d\)</span>-separation in DAGs.
<span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are <span class="math inline">\(c\)</span>-separated by a set <span class="math inline">\(C\)</span> if and only if they are separated in
the graph formed by moralizing the anterior graph of <span class="math inline">\(A \cup B \cup C\)</span>.</p>
<p>% The function in the  package can % be used to query a given chain
graph for <span class="math inline">\(c\)</span>-separation. For
example,</p>
<p>% ```{r eval=F} % library(lcd) % is.separated(“e”, “g”, c(“k”),
as(cG1,“matrix”)) % @</p>
<p>% ```{r echo=F, eval=F} % detach(package:lcd) % @</p>
<p>% % implies that <span class="math inline">\(e \not \negthinspace
\negthinspace \negthinspace \cip g \cd k\)</span> for the chain graph
<code>cG1</code> % we considered previously.</p>
</div>
<div class="section level3">
<h3 id="more-about-graphs">More About Graphs<a class="anchor" aria-label="anchor" href="#more-about-graphs"></a>
</h3>
<div class="section level4">
<h4 id="special-properties">Special Properties<a class="anchor" aria-label="anchor" href="#special-properties"></a>
</h4>
<p>{#sec:<a href="graph:properties" class="uri">graph:properties</a>}</p>
<p>A node in an undirected graph is <em>simplicial</em> if its boundary
is complete.</p>
<p></p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">is.simplicial</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">simplicialNodes</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "a" "c" "d" "e"</span></span></code></pre>
<p>To obtain the <em>connected components</em> of a graph:</p>
<p></p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">connComp</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 2</span></span>
<span><span class="co">##  $ : chr [1:4] "a" "b" "c" "d"</span></span>
<span><span class="co">##  $ : chr "e"</span></span></code></pre>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Using igraph</span></span>
<span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/components.html" class="external-link">components</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 3</span></span>
<span><span class="co">##  $ membership: Named num [1:5] 1 1 1 1 2</span></span>
<span><span class="co">##   ..- attr(*, "names")= chr [1:5] "a" "b" "c" "d" ...</span></span>
<span><span class="co">##  $ csize     : num [1:2] 4 1</span></span>
<span><span class="co">##  $ no        : num 2</span></span></code></pre>
<p> </p>
<p>If a cycle <span class="math inline">\(\alpha=\alpha_0,\alpha_1,\dots,\alpha_n=\alpha\)</span>
has adjacent elements <span class="math inline">\(\alpha_i \sim
\alpha_j\)</span> with $j {i-1,i+1} $ then it is said to have a
<em>chord</em>. If it has no chords it is said to be <em>chordless</em>.
A graph with no chordless cycles of length <span class="math inline">\(\ge 4\)</span> is called <em>triangulated</em> or
<em>chordal</em>:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">is.triangulated</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/is_chordal.html" class="external-link">is_chordal</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $chordal</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $fillin</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $newgraph</span></span>
<span><span class="co">## NULL</span></span></code></pre>
<p>Triangulated graphs are of special interest for graphical models as
they admit closed-form maximum likelihood estimates and allow
considerable computational simplification by decomposition.</p>
<p>A triple <span class="math inline">\((A,B,D)\)</span> of non–empty
disjoint subsets of <span class="math inline">\(V\)</span> is said to
<em>decompose</em> <span class="math inline">\(\cal G\)</span> into
<span class="math inline">\(\cal G_{A\cup D}\)</span> and <span class="math inline">\(\cal G_{B\cup D}\)</span> if <span class="math inline">\(V = A \cup B \cup D\)</span> where <span class="math inline">\(D\)</span> is complete and separates <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</p>
<p> </p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">is.decomposition</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"d"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span>, <span class="va">ug0</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<p>Note that although <span class="math inline">\(\{d\}\)</span> is
complete and separates <span class="math inline">\(\{a\}\)</span> and
<span class="math inline">\(\{b,c\}\)</span> in <code>ug0</code>, the
condition fails because <span class="math inline">\(V \neq
\{a,b,c,d\}\)</span>.</p>
<p> </p>
<p>A graph is <em>decomposable</em> if it is complete or if it can be
decomposed into decomposable subgraphs. A graph is decomposable if and
only if it is triangulated.</p>
<p>An ordering of the nodes in a graph is called a <em>perfect
ordering</em> if <span class="math inline">\(\bound(i)\cap\{1,\dots,i-1\}\)</span> is complete
for all <span class="math inline">\(i\)</span>. Such an ordering exists
if and only if the graph is triangulated. If the graph is triangulated,
then a perfect ordering can be obtained with the <em>maximum cardinality
search</em> (or mcs) algorithm. The function will produce such an
ordering if the graph is triangulated; otherwise it will return
<code>NULL</code>.</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">myplot</span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/GRAPHunnamed-chunk-39-1.png" width="700"></p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-mcs.html">mcs</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "a" "b" "c" "d" "e"</span></span></code></pre>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/max_cardinality.html" class="external-link">max_cardinality</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $alpha</span></span>
<span><span class="co">## [1] 5 4 2 3 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $alpham1</span></span>
<span><span class="co">## + 5/5 vertices, named, from 0325f2d:</span></span>
<span><span class="co">## [1] e c d b a</span></span></code></pre>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/max_cardinality.html" class="external-link">max_cardinality</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span><span class="op">$</span><span class="va">alpham1</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="st">"names"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "e" "c" "d" "b" "a"</span></span></code></pre>
<p>Sometimes it is convenient to have some control over the ordering
given to the variables:</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-mcs.html">mcs</a></span><span class="op">(</span><span class="va">ug0</span>, root<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"c"</span>, <span class="st">"a"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "d" "c" "b" "a" "e"</span></span></code></pre>
<p>Here tries to follow the ordering given and succeeds for the first
two variables but then fails afterwards.</p>
<p> </p>
<p>The cliques of a triangulated undirected graph can be ordered as
<span class="math inline">\((C_1, \dots, C_Q)\)</span> to have the
<em>running intersection property</em> (also called a <em>RIP
ordering</em>). The running intersection property is that <span class="math inline">\(C_j \cap (C_1 \cup \dots \cup C_{j-1}) \subset
C_i\)</span> for some <span class="math inline">\(i&lt;j\)</span> for
<span class="math inline">\(j=2,\dots, Q\)</span>. We define the sets
<span class="math inline">\(S_j=C_j \cap (C_1 \cup \dots \cup
C_{j-1})\)</span> and <span class="math inline">\(R_j=C_j\setminus
S_j\)</span> with <span class="math inline">\(S_1=\emptyset\)</span>.
The sets <span class="math inline">\(S_j\)</span> are called
<em>separators</em> as they separate <span class="math inline">\(R_j\)</span> from <span class="math inline">\((C_1
\cup \dots \cup C_{j-1})\setminus S_j\)</span>. Any clique <span class="math inline">\(C_i\)</span> where <span class="math inline">\(S_j\subset C_i\)</span> with <span class="math inline">\(i&lt;j\)</span> is a possible parent of <span class="math inline">\(C_i\)</span>. The function returns such an
ordering if the graph is triangulated (otherwise, it returns
<code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>):</p>
<p></p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-rip.html">rip</a></span><span class="op">(</span><span class="va">ug0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## cliques</span></span>
<span><span class="co">##   1 : a b </span></span>
<span><span class="co">##   2 : b c d </span></span>
<span><span class="co">##   3 : e </span></span>
<span><span class="co">## separators</span></span>
<span><span class="co">##   1 :  </span></span>
<span><span class="co">##   2 : b </span></span>
<span><span class="co">##   3 :  </span></span>
<span><span class="co">## parents</span></span>
<span><span class="co">##   1 : 0 </span></span>
<span><span class="co">##   2 : 1 </span></span>
<span><span class="co">##   3 : 0</span></span></code></pre>
<p>If a graph is not triangulated it can be made so by adding extra
edges, so called <em>fill-ins</em>, using :</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ug2</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-create.html">ug</a></span><span class="op">(</span><span class="op">~</span><span class="va">a</span><span class="op">:</span><span class="va">b</span><span class="op">:</span><span class="va">c</span> <span class="op">+</span> <span class="va">c</span><span class="op">:</span><span class="va">d</span> <span class="op">+</span> <span class="va">d</span><span class="op">:</span><span class="va">e</span> <span class="op">+</span> <span class="va">a</span><span class="op">:</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="va">ug2</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-create.html">ug</a></span><span class="op">(</span><span class="op">~</span><span class="va">a</span><span class="op">:</span><span class="va">b</span><span class="op">:</span><span class="va">c</span> <span class="op">+</span> <span class="va">c</span><span class="op">:</span><span class="va">d</span> <span class="op">+</span> <span class="va">d</span><span class="op">:</span><span class="va">e</span> <span class="op">+</span> <span class="va">e</span><span class="op">:</span><span class="va">f</span> <span class="op">+</span> <span class="va">a</span><span class="op">:</span><span class="va">f</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">is.triangulated</a></span><span class="op">(</span><span class="va">ug2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/is_chordal.html" class="external-link">is_chordal</a></span><span class="op">(</span><span class="va">ug2</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 3</span></span>
<span><span class="co">##  $ chordal : logi FALSE</span></span>
<span><span class="co">##  $ fillin  : NULL</span></span>
<span><span class="co">##  $ newgraph: NULL</span></span></code></pre>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">myplot</span><span class="op">(</span><span class="va">ug2</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/GRAPHunnamed-chunk-44-1.png" width="700"></p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ug3</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-triangulate.html">triangulate</a></span><span class="op">(</span><span class="va">ug2</span><span class="op">)</span></span>
<span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">is.triangulated</a></span><span class="op">(</span><span class="va">ug3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zzz</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/is_chordal.html" class="external-link">is_chordal</a></span><span class="op">(</span><span class="va">ug2</span>, fillin<span class="op">=</span><span class="cn">TRUE</span>, newgraph<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ug2</span><span class="op">)</span><span class="op">[</span><span class="va">zzz</span><span class="op">$</span><span class="va">fillin</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## + 4/6 vertices, named, from b42467a:</span></span>
<span><span class="co">## [1] d a e a</span></span></code></pre>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ug32</span> <span class="op">&lt;-</span> <span class="va">zzz</span><span class="op">$</span><span class="va">newgraph</span></span></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/layout.deprecated.html" class="external-link">layout.fruchterman.reingold</a></span><span class="op">(</span><span class="va">ug2</span><span class="op">)</span> </span>
<span><span class="fu">myplot</span><span class="op">(</span><span class="va">ug2</span>, layout<span class="op">=</span><span class="va">lay</span><span class="op">)</span>;</span>
<span><span class="fu">myplot</span><span class="op">(</span><span class="va">ug3</span>, layout<span class="op">=</span><span class="va">lay</span><span class="op">)</span>;</span>
<span><span class="fu">myplot</span><span class="op">(</span><span class="va">ug32</span>, layout<span class="op">=</span><span class="va">lay</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/GRAPHunnamed-chunk-47-1.png" width="700"></p>
<p>% Recall that an undirected graph <span class="math inline">\(\cal
G\)</span> is triangulated (or chordal) if it % has no cycles of length
<span class="math inline">\(&gt;= 4\)</span> without a chord. % A graph
is triangulated if and only if there exists a perfect ordering of its
vertices. % Any undirected graph <span class="math inline">\(\cal
G\)</span> can be triangulated by adding edges to % the graph, so called
fill–ins, resulting in a graph <span class="math inline">\(\cal
G^*\)</span>, say. Some of the fill–ins on <span class="math inline">\(\cal G^*\)</span> may be superfluous % in the
sense that they could be removed and still give a triangulated graph. A
% triangulation with no superfluous fill-ins is called a
<em>minimal</em> triangulation. In % general this is not unique. This
should be distinguished from a <em>minimum</em> % triangulation which is
a graph with the smallest number of % fill-ins. Finding a minimum %
triangulation is known to be NP-hard. The function % finds a minimal
triangulation. Consider the following:</p>
<p>% </p>
<p>% ```{r mintri, , include=F, eval=F} % G1 &lt;-
gRbase::ug(~a:b+b:c+c:d+d:e+e:f+a:f+b:e) % mt1.G1 &lt;-
minimalTriang(G1) % G2 &lt;- gRbase::ug(~a:b:e:f+b:c:d:e) %
mt2.G1&lt;-minimalTriang(G1, TuG=G2) % par(mfrow=c(2,2)) % plot(G1,
sub=“G1”) % plot(mt1.G1, sub=“mt1.G1”) % plot(G2, sub=“G2”) %
plot(mt2.G1, sub=“mt2.G1”) % @</p>
<p>% % </p>
<p>% The graph <code>G1</code> is not triangulated; %
<code>mt1.G1} is a minimal triangulation of \code{G1</code>. %
Furthermore, <code>G2} is a triangulation of \code{G1</code>, but it is
not % a minimal triangulation. Finally, <code>mt2.G1</code> is a minimal
% triangulation of <code>G1} formed on the basis of \code{G2</code>.</p>
<p>% </p>
<p>% The <em>maximal prime subgraph decomposition</em> of an undirected
graph % is the smallest subgraphs into which the graph can be %
decomposed.</p>
<p>% Consider the following code fragment:</p>
<p>% ```{r mps, , include=F, eval=F} % G1 &lt;-
gRbase::ug(~a:b+b:c+c:d+d:e+e:f+a:f+b:e) % G1.rip &lt;- mpd(G1) % G1.rip
% par(mfrow=c(1,3)) % plot(G1, main=“G1”) % plot(subGraph(G1.rip<span class="math inline">\(cliques[[1]], G1), main="subgraph 1") %
plot(subGraph(G1.rip\)</span>cliques[[2]], G1), main=“subgraph 2”) %
@</p>
<p>% @ % ```{r echo=F, eval=F} %
pdf(file=“fig/GRAPH-mps.pdf”,width=8,height=5/1.7) % &lt;<mps>&gt; %
graphics.off() % @</mps></p>
<p>% % </p>
<p>% Here is not decomposable but the graph can be % decomposed. The
function returns a junction % RIP–order representation of the maximal
prime subgraph % decomposition. The subgraphs of defined by the cliques
listed % in are the smallest subgraphs into which can % be
decomposed.</p>
<p></p>
<p>The <em>Markov blanket</em> of a vertex <span class="math inline">\(v\)</span> in a DAG may be defined as the minimal
set that <span class="math inline">\(d\)</span>-separates <span class="math inline">\(v\)</span> from the remaining variables. It is
easily derived as the set of neighbours to <span class="math inline">\(v\)</span> in the moral graph of <span class="math inline">\(\cal G\)</span>. For example, the Markov blanket
of vertex <code>e} in \code{dag0</code> is</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/graph_query.html">adj</a></span><span class="op">(</span><span class="fu"><a href="../reference/graph-moralize.html">moralize</a></span><span class="op">(</span><span class="va">dag0</span><span class="op">)</span>, <span class="st">"e"</span><span class="op">)</span></span></code></pre></div>
<p>It is easily seen that the Markov blanket of <span class="math inline">\(v\)</span> is the union of <span class="math inline">\(v\)</span>’s parents, <span class="math inline">\(v\)</span>’s children, and the parents of <span class="math inline">\(v\)</span>’s children.</p>
%
<p>% {#sec:<a href="graph:layout" class="uri">graph:layout</a>}</p>
<p>% [THIS SECTION HAS BEEN REMOVED]</p>
<p>% Although the way graphs are displayed on the page or screen has no
% bearing on their mathematical or statistical properties, in practice %
it is helpful to display them in a way that clearly reveals their %
structure. The  package implements several methods for % automatically
setting graph layouts. We sketch these very briefly % here: for more
detailed information see the online help files, for % example, type
<code><a href="https://rdrr.io/r/grDevices/plotmath.html" class="external-link">?dot</a></code>.</p>
<p>% \begin{itemize} % - The <em>dot</em> method, which is default, is
intended for drawing % DAGs or hierarchies such as organograms or
phylogenies. % - The <em>twopi</em> method is suitable for connected
graphs: it % produces a circular layout with one node placed at the
centre and % others placed on a series of concentric circles about the
centre. % - The <em>circo</em> method also produces a circular layout. %
- The <em>neato</em> method is suitable for undirected graphs: an %
iterative algorithm determines the coordinates of the nodes so that %
the geometric distance between node-pairs approximates their path %
distance in the graph. % - Similarly, the <em>fdp</em> method is based
on an iterative % algorithm due to <span class="citation">@Fruchterman1991</span>, in which adjacent nodes are %
attracted and non-adjacent nodes are repulsed. % \end{itemize}</p>
<p>% The graphs displayed using <code>Rgraphviz</code> can also be
embellished in % various ways: the following example displays the text
in red and fills % the nodes with light grey.</p>
<p>% @ % ```{r } % plot(dag0, attrs=list(node =
list(fillcolor=“lightgrey”,fontcolor=“red”))) % @</p>
<p>% Graph layouts can be reused: this can be useful, for example to
would-be authors of % books on graphical modelling who would like to
compare alternative models for the same dataset. % We illustrate how to
plot a graph and the graph obtained by removing an edge using the same
layout. % To do this, we use the function generate an
<code>Ragraph</code> object, which is a representation % of the layout
of a graph (rather than of the graph as a mathematical object). % From
this we remove the required edge.</p>
<p>% ```{r , eval=F} % edgeNames(ug3)<br>
% ng3 &lt;- agopen(ug3, name=“ug3”, layoutType=“neato”)<br>
% ng4 &lt;- ng3 % AgEdge(ng4) &lt;- AgEdge(ng4)[-3]<br>
% plot(ng3) % @</p>
<p>% ```{r , eval=F} % plot(ng4) % @</p>
<p>% The following example illustrates how individual edge and node
attributes may be set. We use the % chain graph <code>cG1</code>
described above.</p>
<p>% %sæt figurstørrelse i Sweave % ```{r , eval=F} % cG1a &lt;- as(cG1,
“graphNEL”) % nodes(cG1a) &lt;-
c(“alpha”,“theta”,“tau”,“beta”,“pi”,“upsilon”,“gamma”, %
“iota”,“phi”,“delta”,“kappa”) % edges &lt;- buildEdgeList(cG1a) % for (i
in 1:length(edges)) { % if (edges[[i]]<span class="citation">@attrs$dir</span>==“both”) edges[[i]]<span class="citation">@attrs$dir</span> &lt;- “none” % edges[[i]]<span class="citation">@attrs$color</span> &lt;- “blue” % }<br>
% nodes &lt;- buildNodeList(cG1a) % for (i in 1:length(nodes)) { %
nodes[[i]]<span class="citation">@attrs$fontcolor</span> &lt;- “red” %
nodes[[i]]<span class="citation">@attrs$shape</span> &lt;- “ellipse” %
nodes[[i]]<span class="citation">@attrs$fillcolor</span> &lt;-
“lightgrey” % if (i &lt;= 4) { % nodes[[i]]<span class="citation">@attrs$fillcolor</span> &lt;- “lightblue” %
nodes[[i]]<span class="citation">@attrs$shape</span> &lt;- “box” % } % }
% cG1al &lt;- agopen(cG1a, edges=edges, nodes=nodes, name=“cG1a”,
layoutType=“neato”) % plot(cG1al) % @ % %sæt figurstørrelse i Sweave</p>
<p>{#sec:<a href="graph:igraph" class="uri">graph:igraph</a>}</p>
<p>It is possible to create <code>igraph</code> objects using the
function:</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ug4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_literal.html" class="external-link">graph.formula</a></span><span class="op">(</span><span class="va">a</span> <span class="op">-</span><span class="op">-</span> <span class="va">b</span><span class="op">:</span><span class="va">c</span>, <span class="va">c</span><span class="op">-</span><span class="op">-</span><span class="va">b</span><span class="op">:</span><span class="va">d</span>, <span class="va">e</span> <span class="op">-</span><span class="op">-</span> <span class="va">a</span><span class="op">:</span><span class="va">d</span><span class="op">)</span> </span>
<span><span class="va">ug4</span></span></code></pre></div>
<pre><code><span><span class="co">## IGRAPH 8acb390 UN-- 5 6 -- </span></span>
<span><span class="co">## + attr: name (v/c)</span></span>
<span><span class="co">## + edges from 8acb390 (vertex names):</span></span>
<span><span class="co">## [1] a--b a--c a--e b--c c--d d--e</span></span></code></pre>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">myplot</span><span class="op">(</span><span class="va">ug4</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/GRAPHunnamed-chunk-49-1.png" width="700"></p>
<p>The same graph may be created from scratch as follows:</p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ug4.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/make_empty_graph.html" class="external-link">graph.empty</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">5</span>, directed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ug4.2</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ug4.2</span><span class="op">)</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="va">ug4.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/add.edges.html" class="external-link">add.edges</a></span><span class="op">(</span><span class="va">ug4.2</span>, <span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>,<span class="fl">2</span>, <span class="fl">0</span>,<span class="fl">4</span>, <span class="fl">1</span>,<span class="fl">2</span>, <span class="fl">2</span>,<span class="fl">3</span>, <span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: `add.edges()` was deprecated in igraph 2.0.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `add_edges()` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ug4.2</span></span></code></pre></div>
<pre><code><span><span class="co">## IGRAPH 313d2a2 UN-- 5 6 -- </span></span>
<span><span class="co">## + attr: label (v/c), name (v/c)</span></span>
<span><span class="co">## + edges from 313d2a2 (vertex names):</span></span>
<span><span class="co">## [1] a--b a--c a--e b--c c--d d--e</span></span></code></pre>
<p>The graph is displayed using the function, with a layout determined
using the <code>graphopt</code> method. A variety of layout algorithms
are available: type <code><a href="https://r.igraph.org/reference/layout_.html" class="external-link">?layout</a></code> for an overview. Note that per
default the nodes are labelled <span class="math inline">\(0, 1,
\dots\)</span> and so forth. We show how to modify this shortly.</p>
<p>As mentioned previously we have created a custom function which
creates somewhat more readable plots:</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">myplot</span><span class="op">(</span><span class="va">ug4</span>, layout<span class="op">=</span><span class="va">layout.graphopt</span><span class="op">)</span></span></code></pre></div>
<p>Objects in graphs are defined in terms of node and edge lists. In
addition, they have <em>attributes</em>: these belong to the vertices,
the edges or to the graph itself. The following example sets a graph
attribute, <em>layout</em>, and two vertex attributes, <em>label</em>
and <em>color</em>. These are used when the graph is plotted. The
<em>name</em> attribute contains the node labels.</p>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ug4</span><span class="op">$</span><span class="va">layout</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/layout.graphopt.html" class="external-link">layout.graphopt</a></span><span class="op">(</span><span class="va">ug4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: `layout.graphopt()` was deprecated in igraph 2.0.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `layout_with_graphopt()` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ug4</span><span class="op">)</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ug4</span><span class="op">)</span><span class="op">$</span><span class="va">name</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ug4</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="st">"red"</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ug4</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="st">"green"</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ug4</span><span class="op">)</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ug4</span><span class="op">)</span><span class="op">$</span><span class="va">label.cex</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ug4</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/GRAPHunnamed-chunk-52-1.png" width="700"></p>
<p>Note the use of array indices to access the attributes of the
individual vertices. Currently, the indices are zero-based, so that
<code>V(ug4)[1]</code> refers to the second node (B). (This may change).
Edges attributes are accessed similarly, using a container structure
<code>E(ug4)</code>: also here the indices are zero-based
(currently).</p>
<p>It is easy to extend <code>igraph</code> objects by defining new
attributes. In the following example we define a new vertex attribute,
<code>discrete</code>, and use this to color the vertices.</p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ug5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/set.vertex.attribute.html" class="external-link">set.vertex.attribute</a></span><span class="op">(</span><span class="va">ug4</span>, <span class="st">"discrete"</span>, value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">T</span>, <span class="cn">T</span>, <span class="cn">F</span>, <span class="cn">F</span>, <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: `set.vertex.attribute()` was deprecated in igraph 2.0.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `set_vertex_attr()` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ug5</span><span class="op">)</span><span class="op">[</span><span class="va">discrete</span><span class="op">]</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="st">"green"</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ug5</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="va">discrete</span><span class="op">]</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="st">"red"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ug5</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/GRAPHunnamed-chunk-53-1.png" width="700"></p>
<p>A useful interactive drawing facility is provided with the function.
This causes a pop-up window to appear in which the graph can be manually
edited. One use of this is to edit the layout of the graph: the new
coordinates can be extracted and re-used by the function. For
example</p>
<p></p>
<p>The function returns a window id (here 2). While the popup window is
open, the current layout can be obtained by passing the window id to the
function, as for example</p>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/tkplot.getcoords.html" class="external-link">tkplot.getcoords</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g</span>, layout<span class="op">=</span><span class="va">xy</span><span class="op">)</span></span></code></pre></div>
<p>It is straightforward to reuse layout information with
<code>igraph</code> objects. The layout functions when applied to graphs
return a matrix of <span class="math inline">\((x,y)\)</span>
coordinates:</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://r.igraph.org/reference/layout.deprecated.html" class="external-link">layout.fruchterman.reingold</a></span><span class="op">(</span><span class="va">ug4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           [,1]        [,2]</span></span>
<span><span class="co">## [1,] 0.6566656  0.44492190</span></span>
<span><span class="co">## [2,] 0.5694600  1.59127688</span></span>
<span><span class="co">## [3,] 1.5610941  1.00955841</span></span>
<span><span class="co">## [4,] 2.2763862 -0.05491895</span></span>
<span><span class="co">## [5,] 1.2989422 -0.66513915</span></span></code></pre>
<p>Most layout algorithms use a random generator to choose an initial
configuration. Hence if we set the layout attribute to be a layout
function, repeated calls to plot will use different layouts. For
example, after</p>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ug4</span><span class="op">$</span><span class="va">layout</span> <span class="op">&lt;-</span> <span class="va">layout.fruchterman.reingold</span></span></code></pre></div>
<p>repeated invocations of <code>plot(ug4)</code> will use different
layouts. In contrast, after</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ug4</span><span class="op">$</span><span class="va">layout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/layout.deprecated.html" class="external-link">layout.fruchterman.reingold</a></span><span class="op">(</span><span class="va">ug4</span><span class="op">)</span></span></code></pre></div>
<p>the layout will be fixed. The following code fragment illustrates how
two graphs with the same vertex set may be plotted using the same
layout.</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ug5</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-create.html">ug</a></span><span class="op">(</span><span class="op">~</span><span class="va">A</span><span class="op">*</span><span class="va">B</span><span class="op">*</span><span class="va">C</span> <span class="op">+</span> <span class="va">B</span><span class="op">*</span><span class="va">C</span><span class="op">*</span><span class="va">D</span> <span class="op">+</span> <span class="va">D</span><span class="op">*</span><span class="va">E</span><span class="op">)</span></span>
<span><span class="va">ug6</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-create.html">ug</a></span><span class="op">(</span><span class="op">~</span><span class="va">A</span><span class="op">*</span><span class="va">B</span> <span class="op">+</span> <span class="va">B</span><span class="op">*</span><span class="va">C</span> <span class="op">+</span> <span class="va">C</span><span class="op">*</span><span class="va">D</span> <span class="op">+</span> <span class="va">D</span><span class="op">*</span><span class="va">E</span><span class="op">)</span> </span>
<span><span class="va">lay.fr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/layout.deprecated.html" class="external-link">layout.fruchterman.reingold</a></span><span class="op">(</span><span class="va">ug5</span><span class="op">)</span></span>
<span><span class="va">ug6</span><span class="op">$</span><span class="va">layout</span>       <span class="op">&lt;-</span> <span class="va">ug5</span><span class="op">$</span><span class="va">layout</span>       <span class="op">&lt;-</span> <span class="va">lay.fr</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ug5</span><span class="op">)</span><span class="op">$</span><span class="va">size</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ug6</span><span class="op">)</span><span class="op">$</span><span class="va">size</span>      <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ug5</span><span class="op">)</span><span class="op">$</span><span class="va">label.cex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">ug6</span><span class="op">)</span><span class="op">$</span><span class="va">label.cex</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ug5</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ug6</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/GRAPHsamelay-1.png" width="700"></p>
<p>% %</p>
<p>% @ % ```{r echo=F} %
pdf(file=“fig/GRAPH-samelay2.pdf”,width=8,height=8) % &lt;<samelay>&gt;
% graphics.off() % @</samelay></p>
<p>% </p>
<p>An overview of attributes used in plotting can be obtained by typing
<code><a href="https://r.igraph.org/reference/plot.common.html" class="external-link">?igraph.plotting</a></code>. A final example illustrates how more
complex graphs can be displayed:</p>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">em1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>,</span>
<span>                <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>                <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>                <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">iG</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph.adjacency.html" class="external-link">graph.adjacency</a></span><span class="op">(</span><span class="va">em1</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## Warning: `graph.adjacency()` was deprecated in igraph 2.0.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `graph_from_adjacency_matrix()` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">iG</span><span class="op">)</span><span class="op">$</span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"circle"</span>, <span class="st">"square"</span>, <span class="st">"circle"</span>, <span class="st">"square"</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">iG</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"green"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">iG</span><span class="op">)</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">iG</span><span class="op">)</span><span class="op">$</span><span class="va">arrow.mode</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://r.igraph.org/reference/is.mutual.html" class="external-link">is.mutual</a></span><span class="op">(</span><span class="va">iG</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">iG</span><span class="op">)</span><span class="op">$</span><span class="va">color</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"black"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">iG</span><span class="op">)</span><span class="op">$</span><span class="va">curved</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">T</span>, <span class="cn">F</span>, <span class="cn">F</span>, <span class="cn">F</span>, <span class="cn">F</span>, <span class="cn">F</span><span class="op">)</span> </span>
<span><span class="va">iG</span><span class="op">$</span><span class="va">layout</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/layout.graphopt.html" class="external-link">layout.graphopt</a></span><span class="op">(</span><span class="va">iG</span><span class="op">)</span></span>
<span><span class="fu">myplot</span><span class="op">(</span><span class="va">iG</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/GRAPHunnamed-chunk-58-1.png" width="700"></p>
<p>% ### 3-D graphs</p>
<p>% [THIS SECTION HAS BEEN REMOVED]</p>
<p>% The function in the  package displays a graph in % three
dimensions. Using a mouse, the graph can be rotated and<br>
% zoomed. Opinions differ as to how useful this is. The following code
fragment % can be used to try the facility. First we derive the
adjacency matrix of a<br>
% built-in graph in the  package, then we display it % as a
(pseudo)-three-dimensional graph.</p>
<p>% ```{r eval=F} % library(sna) % aG &lt;-
as(graph.famous(“Meredith”),“matrix”) % gplot3d(aG) % @</p>
<p>% ### Alternative Graph Representations % {#sec:<a href="graph:representations" class="uri">graph:representations</a>}</p>
<p>% [THIS SECTION HAS BEEN REMOVED] % As mentioned above,
<code>graphNEL</code> objects are so-called because they % use a node
and edge list representation. So these can also be created % directly,
by specifying a vector of nodes and a list containing the % edges
corresponding to each node. For example,</p>
<p>% @ % ```{r , eval=F} % V &lt;- c(“a”,“b”,“c”,“d”) % edL &lt;-
vector(“list”, length=4) % names(edL) &lt;- V % for (i in 1:4) { %
edL[[i]] &lt;- list(edges=5-i) % } % gR &lt;- new(“graphNEL”, nodes=V,
edgeL=edL) % plot(gR) % @</p>
<p>% ### Different Graph Representations and Coercion between these %
{#sec:graphs:coercion}</p>
<p>% Default is that and return a graph in the % <code>graphNEL</code>
representation. Alternative representations are % obtained using: % @ %
```{r print=T} % ug_igraph &lt;- ug(~a:b+b:c:d+e, result=“igraph”) %
ug_matrix &lt;- ug(~a:b+b:c:d+e, result=“matrix”) % @</p>
<p>% It is possible convert between different representations of
undirected % graphs and DAGs using :</p>
<p>% @ % ```{r print=T} % ug_NEL &lt;- as(ug_igraph, “graphNEL”) %
ug_matrix &lt;- as(ug_NEL, “matrix”) % ug_igraph2 &lt;- as(ug_matrix,
“igraph”) % @</p>
</div>
<div class="section level4">
<h4 id="operations-on-graphs-in-different-representations">Operations on Graphs in Different Representations<a class="anchor" aria-label="anchor" href="#operations-on-graphs-in-different-representations"></a>
</h4>
<p>{#sec:<a href="graph:querygraph" class="uri">graph:querygraph</a>}</p>
<p>% The functions for operations on graphs illustrated in the previous
sections are all % available for graphs in the <code>graphNEL</code>
representation (some % operations are in fact available for graphs in
the other % representations as well). Notice that the functions differ
in whether % they take the graph as the first or as the last argument
(that is % mainly related to different styles in different
packages).</p>
<p></p>
<p>The  package has a function which provides a common interface to the
graph operations for undirected graphs and DAGs illustrated above.
Moreover, works on graphs represented as <code>igraph</code> objects and
adjacency matrices. The general syntax is</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/args.html" class="external-link">args</a></span><span class="op">(</span><span class="va">querygraph</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## function (object, op, set = NULL, set2 = NULL, set3 = NULL) </span></span>
<span><span class="co">## NULL</span></span></code></pre>
<p>For example, we obtain:</p>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ug_</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph-create.html">ug</a></span><span class="op">(</span><span class="op">~</span><span class="va">a</span><span class="op">:</span><span class="va">b</span> <span class="op">+</span> <span class="va">b</span><span class="op">:</span><span class="va">c</span><span class="op">:</span><span class="va">d</span> <span class="op">+</span> <span class="va">e</span><span class="op">)</span></span>
<span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">separates</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"d"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span>, <span class="va">ug_</span><span class="op">)</span>                   </span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">querygraph</a></span><span class="op">(</span><span class="va">ug_</span>, <span class="st">"separates"</span>, <span class="st">"a"</span>, <span class="st">"d"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gRbase</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_query.html">qgraph</a></span><span class="op">(</span><span class="va">ug_</span>, <span class="st">"separates"</span>, <span class="st">"a"</span>, <span class="st">"d"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>\end{document}</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Søren Højsgaard.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
