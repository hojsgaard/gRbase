<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Array operations with the gRbase package • gRbase</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Array operations with the gRbase package">
<meta property="og:description" content="gRbase">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gRbase</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/arrays.html">Array operations with the gRbase package</a>
    </li>
    <li>
      <a href="../articles/graphs.html">Graphs with the gRbase package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Array operations with the gRbase package</h1>
                        <h4 data-toc-skip class="author">Søren
Højsgaard</h4>
            
      
      
      <div class="hidden name"><code>arrays.rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This note describes some operations on arrays in R. These operations
have been implemented to facilitate implementation of graphical models
and Bayesian networks in R.</p>
<div class="section level3">
<h3 id="arraystables-in-r">Arrays/tables in R<a class="anchor" aria-label="anchor" href="#arraystables-in-r"></a>
</h3>
<p>The documentation of R states the following about arrays: <em>An
array in R can have one, two or more dimensions. It is simply a vector
which is stored with additional attributes giving the dimensions
(attribute “dim”) and optionally names for those dimensions (attribute
“dimnames”). A two-dimensional array is the same thing as a matrix.
One-dimensional arrays often look like vectors, but may be handled
differently by some functions.</em></p>
</div>
<div class="section level3">
<h3 id="cross-classified-data---contingency-tables">Cross classified data - contingency tables<a class="anchor" aria-label="anchor" href="#cross-classified-data---contingency-tables"></a>
</h3>
<p>Arrays appear for example in connection with cross classified data.
The array hec below is an excerpt of the HairEyeColor array in R:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">32</span>, <span class="fl">53</span>, <span class="fl">11</span>, <span class="fl">50</span>, <span class="fl">10</span>, <span class="fl">25</span>, <span class="fl">36</span>, <span class="fl">66</span>, <span class="fl">9</span>, <span class="fl">34</span>, <span class="fl">5</span>, <span class="fl">29</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">hec</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">hec</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Hair <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Black"</span>, <span class="st">"Brown"</span><span class="op">)</span>, </span>
<span>                      Eye <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Brown"</span>, <span class="st">"Blue"</span>, <span class="st">"Hazel"</span><span class="op">)</span>, </span>
<span>                      Sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">hec</span></span>
<span><span class="co">#&gt; , , Sex = Male</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    32   11    10</span></span>
<span><span class="co">#&gt;   Brown    53   50    25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , Sex = Female</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    36    9     5</span></span>
<span><span class="co">#&gt;   Brown    66   34    29</span></span></code></pre></div>
<p>Above, hec is an array because it has a dim attribute. Moreover, also
has a dimnames attribute naming the levels of each dimension. Notice
that each dimension is given a name.</p>
<p>Printing arrays can take up a lot of space. Alternative views on an
array can be obtained with ftable() or by converting the array to a
dataframe with as.data.frame.table(). We shall do so in the
following.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##flat &lt;- function(x) {ftable(x, row.vars=1)}</span></span>
<span><span class="va">flat</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span><span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">as.data.frame.table</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">hec</span> <span class="op">|&gt;</span> <span class="fu">flat</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Hair   Eye  Sex Freq</span></span>
<span><span class="co">#&gt; 1 Black Brown Male   32</span></span>
<span><span class="co">#&gt; 2 Brown Brown Male   53</span></span>
<span><span class="co">#&gt; 3 Black  Blue Male   11</span></span>
<span><span class="co">#&gt; 4 Brown  Blue Male   50</span></span></code></pre></div>
<p>An array with named dimensions is in this package called a <em>named
array</em>. The functionality described below relies heavily on arrays
having named dimensions. A check for an object being a named array is
provided by is.named.array()</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api-array-properties.html">is.named.array</a></span><span class="op">(</span><span class="va">hec</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="defining-arrays">Defining arrays<a class="anchor" aria-label="anchor" href="#defining-arrays"></a>
</h3>
<p>Another way is to use tabNew() from gRbase. This function is flexible
wrt the input; for example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Hair<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Black"</span>, <span class="st">"Brown"</span><span class="op">)</span>, Eye<span class="op">=</span><span class="op">~</span><span class="va">Brown</span><span class="op">:</span><span class="va">Blue</span><span class="op">:</span><span class="va">Hazel</span>, Sex<span class="op">=</span><span class="op">~</span><span class="va">Male</span><span class="op">:</span><span class="va">Female</span><span class="op">)</span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">32</span>, <span class="fl">53</span>, <span class="fl">11</span>, <span class="fl">50</span>, <span class="fl">10</span>, <span class="fl">25</span>, <span class="fl">36</span>, <span class="fl">66</span>, <span class="fl">9</span>, <span class="fl">34</span>, <span class="fl">5</span>, <span class="fl">29</span><span class="op">)</span></span>
<span><span class="va">z3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-tabNew.html">tabNew</a></span><span class="op">(</span><span class="op">~</span><span class="va">Hair</span><span class="op">:</span><span class="va">Eye</span><span class="op">:</span><span class="va">Sex</span>, levels<span class="op">=</span><span class="va">dn</span>, value<span class="op">=</span><span class="va">counts</span><span class="op">)</span> </span>
<span><span class="va">z4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-tabNew.html">tabNew</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hair"</span>, <span class="st">"Eye"</span>, <span class="st">"Sex"</span><span class="op">)</span>, levels<span class="op">=</span><span class="va">dn</span>, values<span class="op">=</span><span class="va">counts</span><span class="op">)</span></span></code></pre></div>
<p>Default dimnames are generated with</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-tabNew.html">tabNew</a></span><span class="op">(</span><span class="op">~</span><span class="va">Hair</span><span class="op">:</span><span class="va">Eye</span><span class="op">:</span><span class="va">Sex</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>, values <span class="op">=</span> <span class="va">counts</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">z5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ Hair: chr [1:2] "1" "2"</span></span>
<span><span class="co">#&gt;  $ Eye : chr [1:3] "1" "2" "3"</span></span>
<span><span class="co">#&gt;  $ Sex : chr [1:2] "1" "2"</span></span></code></pre></div>
<p>Using tabNew, arrays can be normalized to sum to one in two ways: 1)
Normalization can be over the first variable for <em>each</em>
configuration of all other variables and 2) over all configurations. For
example:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-tabNew.html">tabNew</a></span><span class="op">(</span><span class="op">~</span><span class="va">Hair</span><span class="op">:</span><span class="va">Eye</span><span class="op">:</span><span class="va">Sex</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>, values<span class="op">=</span><span class="va">counts</span>, normalize<span class="op">=</span><span class="st">"first"</span><span class="op">)</span></span>
<span><span class="va">z6</span> <span class="op">|&gt;</span> <span class="fu">flat</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Hair Eye Sex  Freq</span></span>
<span><span class="co">#&gt; 1    1   1   1 0.376</span></span>
<span><span class="co">#&gt; 2    2   1   1 0.624</span></span>
<span><span class="co">#&gt; 3    1   2   1 0.180</span></span>
<span><span class="co">#&gt; 4    2   2   1 0.820</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="operations-on-arrays">Operations on arrays<a class="anchor" aria-label="anchor" href="#operations-on-arrays"></a>
</h2>
<p>In the following we shall denote the dimnames (or variables) of the
array by <span class="math inline">\(H\)</span>, <span class="math inline">\(E\)</span> and <span class="math inline">\(S\)</span> and we let <span class="math inline">\((h,e,s)\)</span> denote a configuration of these
variables. The contingency table above shall be denoted by <span class="math inline">\(T_{HES}\)</span> and we shall refer to the <span class="math inline">\((h,e,s)\)</span>-entry of <span class="math inline">\(T_{HES}\)</span> as <span class="math inline">\(T_{HES}(h,e,s)\)</span>.</p>
<div class="section level3">
<h3 id="normalizing-an-array">Normalizing an array<a class="anchor" aria-label="anchor" href="#normalizing-an-array"></a>
</h3>
<p>Normalize an array with Entries of an array can be normalized to sum
to one in two ways: 1) Normalization can be over the first variable for
<em>each</em> configuration of all other variables and 2) over all
configurations. For example:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api-tabX.html">tabNormalize</a></span><span class="op">(</span><span class="va">z5</span>, <span class="st">"first"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">flat</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Hair Eye Sex  Freq</span></span>
<span><span class="co">#&gt; 1    1   1   1 0.376</span></span>
<span><span class="co">#&gt; 2    2   1   1 0.624</span></span>
<span><span class="co">#&gt; 3    1   2   1 0.180</span></span>
<span><span class="co">#&gt; 4    2   2   1 0.820</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="subsetting-an-array-slicing">Subsetting an array – slicing<a class="anchor" aria-label="anchor" href="#subsetting-an-array-slicing"></a>
</h3>
<p>We can subset arrays (this will also be called ``slicing’’) in
different ways. Notice that the result is not necessarily an array.
Slicing can be done using standard R code or using . The virtue of
tabSlice() comes from the flexibility when specifying the slice:</p>
<p>The following leads from the original <span class="math inline">\(2\times 3 \times 2\)</span> array to a <span class="math inline">\(2 \times 2\)</span> array by cutting away the
Sex=Male and Eye=Brown slice of the array:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api_tabSlice.html">tabSlice</a></span><span class="op">(</span><span class="va">hec</span>, slice<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Eye<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Blue"</span>, <span class="st">"Hazel"</span><span class="op">)</span>, Sex<span class="op">=</span><span class="st">"Female"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    9     5</span></span>
<span><span class="co">#&gt;   Brown   34    29</span></span>
<span><span class="co">## Notice: levels can be written as numerics</span></span>
<span><span class="co">## tabSlice(hec, slice=list(Eye=2:3, Sex="Female"))</span></span></code></pre></div>
<p>We may also regard the result above as a <span class="math inline">\(2 \times 2 \times 1\)</span> array:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api_tabSlice.html">tabSlice</a></span><span class="op">(</span><span class="va">hec</span>, slice<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Eye<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Blue"</span>, <span class="st">"Hazel"</span><span class="op">)</span>, Sex<span class="op">=</span><span class="st">"Female"</span><span class="op">)</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; , , Sex = Female</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    9     5</span></span>
<span><span class="co">#&gt;   Brown   34    29</span></span></code></pre></div>
<p>If slicing leads to a one dimensional array, the output will by
default not be an array but a vector (without a dim attribute). However,
the result can be forced to be a 1-dimensional array:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## A vector:</span></span>
<span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api_tabSlice.html">tabSlice</a></span><span class="op">(</span><span class="va">hec</span>, slice<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Hair<span class="op">=</span><span class="fl">1</span>, Sex<span class="op">=</span><span class="st">"Female"</span><span class="op">)</span><span class="op">)</span>; <span class="va">t1</span></span>
<span><span class="co">#&gt; Brown  Blue Hazel </span></span>
<span><span class="co">#&gt;    36     9     5</span></span>
<span><span class="co">## A 1-dimensional array:</span></span>
<span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api_tabSlice.html">tabSlice</a></span><span class="op">(</span><span class="va">hec</span>, slice<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Hair<span class="op">=</span><span class="fl">1</span>, Sex<span class="op">=</span><span class="st">"Female"</span><span class="op">)</span>, as.array<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>; <span class="va">t2</span> </span>
<span><span class="co">#&gt; Eye</span></span>
<span><span class="co">#&gt; Brown  Blue Hazel </span></span>
<span><span class="co">#&gt;    36     9     5</span></span>
<span><span class="co">## A higher dimensional array (in which some dimensions only have one level)</span></span>
<span><span class="va">t3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api_tabSlice.html">tabSlice</a></span><span class="op">(</span><span class="va">hec</span>, slice<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Hair<span class="op">=</span><span class="fl">1</span>, Sex<span class="op">=</span><span class="st">"Female"</span><span class="op">)</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>; <span class="va">t3</span></span>
<span><span class="co">#&gt; , , Sex = Female</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    36    9     5</span></span></code></pre></div>
<p>The difference between the last two forms can be clarified:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t2</span> <span class="op">|&gt;</span> <span class="fu">flat</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Eye Freq</span></span>
<span><span class="co">#&gt; 1 Brown   36</span></span>
<span><span class="co">#&gt; 2  Blue    9</span></span>
<span><span class="co">#&gt; 3 Hazel    5</span></span>
<span><span class="va">t3</span> <span class="op">|&gt;</span> <span class="fu">flat</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Hair   Eye    Sex Freq</span></span>
<span><span class="co">#&gt; 1 Black Brown Female   36</span></span>
<span><span class="co">#&gt; 2 Black  Blue Female    9</span></span>
<span><span class="co">#&gt; 3 Black Hazel Female    5</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="collapsing-and-inflating-arrays---tabmarg-and-tabexpand">Collapsing and inflating arrays - tabMarg() and tabExpand()<a class="anchor" aria-label="anchor" href="#collapsing-and-inflating-arrays---tabmarg-and-tabexpand"></a>
</h3>
<p>Collapsing: The <span class="math inline">\(HE\)</span>–marginal
array <span class="math inline">\(T_{HE}\)</span> of <span class="math inline">\(T_{HES}\)</span> is the array with values
Inflating: The ``opposite’’ operation is to extend an array. For
example, we can extend <span class="math inline">\(T_{HE}\)</span> to
have a third dimension, e.g. . That is so <span class="math inline">\(\tilde T_{SHE}(s,h,e)\)</span> is constant as a
function of <span class="math inline">\(s\)</span>.</p>
<p>With gRbase we can collapse arrays with:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">he</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-tabX.html">tabMarg</a></span><span class="op">(</span><span class="va">hec</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hair"</span>, <span class="st">"Eye"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">he</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    68   20    15</span></span>
<span><span class="co">#&gt;   Brown   119   84    54</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Alternatives</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabMarg</a></span><span class="op">(</span><span class="va">hec</span>, <span class="op">~</span><span class="va">Hair</span><span class="op">:</span><span class="va">Eye</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    68   20    15</span></span>
<span><span class="co">#&gt;   Brown   119   84    54</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabMarg</a></span><span class="op">(</span><span class="va">hec</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    68   20    15</span></span>
<span><span class="co">#&gt;   Brown   119   84    54</span></span>
<span><span class="va">hec</span> <span class="op"><a href="../reference/api-pct-operations.html">%a_%</a></span> <span class="op">~</span><span class="va">Hair</span><span class="op">:</span><span class="va">Eye</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    68   20    15</span></span>
<span><span class="co">#&gt;   Brown   119   84    54</span></span></code></pre></div>
<p>Notice that collapsing is a projection in the sense that applying the
operation again does not change anything (except possibly changing the
order of variables):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">he1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-tabX.html">tabMarg</a></span><span class="op">(</span><span class="va">hec</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hair"</span>, <span class="st">"Eye"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">he2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-tabX.html">tabMarg</a></span><span class="op">(</span><span class="va">he1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Eye"</span>, <span class="st">"Hair"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabEqual</a></span><span class="op">(</span><span class="va">he1</span>, <span class="va">he2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Expand an array by adding additional dimensions with tabExpand():</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">extra.dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Sex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabExpand</a></span><span class="op">(</span><span class="va">he</span>, <span class="va">extra.dim</span><span class="op">)</span> </span>
<span><span class="co">#&gt; , , Sex = Male</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Hair</span></span>
<span><span class="co">#&gt; Eye     Black Brown</span></span>
<span><span class="co">#&gt;   Brown    68   119</span></span>
<span><span class="co">#&gt;   Blue     20    84</span></span>
<span><span class="co">#&gt;   Hazel    15    54</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , Sex = Female</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Hair</span></span>
<span><span class="co">#&gt; Eye     Black Brown</span></span>
<span><span class="co">#&gt;   Brown    68   119</span></span>
<span><span class="co">#&gt;   Blue     20    84</span></span>
<span><span class="co">#&gt;   Hazel    15    54</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Alternatives</span></span>
<span><span class="va">he</span> <span class="op"><a href="../reference/api-pct-operations.html">%a^%</a></span> <span class="va">extra.dim</span></span>
<span><span class="co">#&gt; , , Sex = Male</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Hair</span></span>
<span><span class="co">#&gt; Eye     Black Brown</span></span>
<span><span class="co">#&gt;   Brown    68   119</span></span>
<span><span class="co">#&gt;   Blue     20    84</span></span>
<span><span class="co">#&gt;   Hazel    15    54</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , Sex = Female</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Hair</span></span>
<span><span class="co">#&gt; Eye     Black Brown</span></span>
<span><span class="co">#&gt;   Brown    68   119</span></span>
<span><span class="co">#&gt;   Blue     20    84</span></span>
<span><span class="co">#&gt;   Hazel    15    54</span></span></code></pre></div>
<p>Notice that expanding and collapsing brings us back to where we
started:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">he</span> <span class="op"><a href="../reference/api-pct-operations.html">%a^%</a></span> <span class="va">extra.dim</span><span class="op">)</span> <span class="op"><a href="../reference/api-pct-operations.html">%a_%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hair"</span>, <span class="st">"Eye"</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black   136   40    30</span></span>
<span><span class="co">#&gt;   Brown   238  168   108</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="permuting-an-array-tabperm">Permuting an array – tabPerm()<a class="anchor" aria-label="anchor" href="#permuting-an-array-tabperm"></a>
</h3>
<p>A reorganization of the table can be made with tabPerm() (similar to
aperm()), but tabPerm() allows for a formula and for variable
abbreviation:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api-tabX.html">tabPerm</a></span><span class="op">(</span><span class="va">hec</span>, <span class="op">~</span><span class="va">Eye</span><span class="op">:</span><span class="va">Sex</span><span class="op">:</span><span class="va">Hair</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">flat</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Eye    Sex  Hair Freq</span></span>
<span><span class="co">#&gt; 1 Brown   Male Black   32</span></span>
<span><span class="co">#&gt; 2  Blue   Male Black   11</span></span>
<span><span class="co">#&gt; 3 Hazel   Male Black   10</span></span>
<span><span class="co">#&gt; 4 Brown Female Black   36</span></span></code></pre></div>
<p>Alternative forms (the first two also works for ):</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api-tabX.html">tabPerm</a></span><span class="op">(</span><span class="va">hec</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Eye"</span>, <span class="st">"Sex"</span>, <span class="st">"Hair"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; , , Hair = Black</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Sex</span></span>
<span><span class="co">#&gt; Eye     Male Female</span></span>
<span><span class="co">#&gt;   Brown   32     36</span></span>
<span><span class="co">#&gt;   Blue    11      9</span></span>
<span><span class="co">#&gt;   Hazel   10      5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , Hair = Brown</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Sex</span></span>
<span><span class="co">#&gt; Eye     Male Female</span></span>
<span><span class="co">#&gt;   Brown   53     66</span></span>
<span><span class="co">#&gt;   Blue    50     34</span></span>
<span><span class="co">#&gt;   Hazel   25     29</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabPerm</a></span><span class="op">(</span><span class="va">hec</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt; , , Hair = Black</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Sex</span></span>
<span><span class="co">#&gt; Eye     Male Female</span></span>
<span><span class="co">#&gt;   Brown   32     36</span></span>
<span><span class="co">#&gt;   Blue    11      9</span></span>
<span><span class="co">#&gt;   Hazel   10      5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , Hair = Brown</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Sex</span></span>
<span><span class="co">#&gt; Eye     Male Female</span></span>
<span><span class="co">#&gt;   Brown   53     66</span></span>
<span><span class="co">#&gt;   Blue    50     34</span></span>
<span><span class="co">#&gt;   Hazel   25     29</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabPerm</a></span><span class="op">(</span><span class="va">hec</span>, <span class="op">~</span><span class="va">Ey</span><span class="op">:</span><span class="va">Se</span><span class="op">:</span><span class="va">Ha</span><span class="op">)</span> </span>
<span><span class="co">#&gt; , , Hair = Black</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Sex</span></span>
<span><span class="co">#&gt; Eye     Male Female</span></span>
<span><span class="co">#&gt;   Brown   32     36</span></span>
<span><span class="co">#&gt;   Blue    11      9</span></span>
<span><span class="co">#&gt;   Hazel   10      5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , Hair = Brown</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Sex</span></span>
<span><span class="co">#&gt; Eye     Male Female</span></span>
<span><span class="co">#&gt;   Brown   53     66</span></span>
<span><span class="co">#&gt;   Blue    50     34</span></span>
<span><span class="co">#&gt;   Hazel   25     29</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabPerm</a></span><span class="op">(</span><span class="va">hec</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ey"</span>, <span class="st">"Se"</span>, <span class="st">"Ha"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; , , Hair = Black</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Sex</span></span>
<span><span class="co">#&gt; Eye     Male Female</span></span>
<span><span class="co">#&gt;   Brown   32     36</span></span>
<span><span class="co">#&gt;   Blue    11      9</span></span>
<span><span class="co">#&gt;   Hazel   10      5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , Hair = Brown</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Sex</span></span>
<span><span class="co">#&gt; Eye     Male Female</span></span>
<span><span class="co">#&gt;   Brown   53     66</span></span>
<span><span class="co">#&gt;   Blue    50     34</span></span>
<span><span class="co">#&gt;   Hazel   25     29</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="equality---tabequal">Equality - tabEqual()<a class="anchor" aria-label="anchor" href="#equality---tabequal"></a>
</h3>
<p>Two arrays are defined to be identical 1) if they have the same
dimnames and 2) if, possibly after a permutation, all values are
identical (up to a small numerical difference):</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hec2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-tabX.html">tabPerm</a></span><span class="op">(</span><span class="va">hec</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabEqual</a></span><span class="op">(</span><span class="va">hec</span>, <span class="va">hec2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Alternative</span></span>
<span><span class="va">hec</span> <span class="op"><a href="../reference/api-pct-operations.html">%a==%</a></span> <span class="va">hec2</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="aligning---tabalign">Aligning - tabAlign()<a class="anchor" aria-label="anchor" href="#aligning---tabalign"></a>
</h3>
<p>We can align one array according to the ordering of another:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hec2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-tabX.html">tabPerm</a></span><span class="op">(</span><span class="va">hec</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabAlign</a></span><span class="op">(</span><span class="va">hec2</span>, <span class="va">hec</span><span class="op">)</span></span>
<span><span class="co">#&gt; , , Sex = Male</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    32   11    10</span></span>
<span><span class="co">#&gt;   Brown    53   50    25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , Sex = Female</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    36    9     5</span></span>
<span><span class="co">#&gt;   Brown    66   34    29</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Alternative:</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabAlign</a></span><span class="op">(</span><span class="va">hec2</span>, <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">hec</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; , , Sex = Male</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    32   11    10</span></span>
<span><span class="co">#&gt;   Brown    53   50    25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , Sex = Female</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    36    9     5</span></span>
<span><span class="co">#&gt;   Brown    66   34    29</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multiplication-addition-etc--">Multiplication, addition etc: <span class="math inline">\(+\)</span>, <span class="math inline">\(-\)</span>, <span class="math inline">\(*\)</span>, <span class="math inline">\(/\)</span><a class="anchor" aria-label="anchor" href="#multiplication-addition-etc--"></a>
</h3>
<p>The product of two arrays <span class="math inline">\(T_{HE}\)</span>
and <span class="math inline">\(T_{HS}\)</span> is defined to be the
array <span class="math inline">\(\tilde T_{HES}\)</span> with entries
<span class="math display">\[
  \tilde T_{HES}(h,e,s)= T_{HE}(h,e) + T_{HS}(h,s)
\]</span></p>
<p>The sum, difference and quotient is defined similarly: This is done
with tabProd(), tabAdd(), tabDiff() and tabDiv():</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-tabX.html">tabMarg</a></span><span class="op">(</span><span class="va">hec</span>, <span class="op">~</span><span class="va">Hair</span><span class="op">:</span><span class="va">Eye</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabMult</a></span><span class="op">(</span><span class="va">he</span>, <span class="va">hs</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black  4624  400   225</span></span>
<span><span class="co">#&gt;   Brown 14161 7056  2916</span></span></code></pre></div>
<p>Available operations:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api-tabX.html">tabAdd</a></span><span class="op">(</span><span class="va">he</span>, <span class="va">hs</span><span class="op">)</span> </span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black   136   40    30</span></span>
<span><span class="co">#&gt;   Brown   238  168   108</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabSubt</a></span><span class="op">(</span><span class="va">he</span>, <span class="va">hs</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black     0    0     0</span></span>
<span><span class="co">#&gt;   Brown     0    0     0</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabMult</a></span><span class="op">(</span><span class="va">he</span>, <span class="va">hs</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black  4624  400   225</span></span>
<span><span class="co">#&gt;   Brown 14161 7056  2916</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabDiv</a></span><span class="op">(</span><span class="va">he</span>, <span class="va">hs</span><span class="op">)</span> </span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black     1    1     1</span></span>
<span><span class="co">#&gt;   Brown     1    1     1</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabDiv0</a></span><span class="op">(</span><span class="va">he</span>, <span class="va">hs</span><span class="op">)</span> <span class="co">## Convention 0/0 = 0</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black     1    1     1</span></span>
<span><span class="co">#&gt;   Brown     1    1     1</span></span></code></pre></div>
<p>Shortcuts:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Alternative</span></span>
<span><span class="va">he</span> <span class="op"><a href="../reference/api-pct-operations.html">%a+%</a></span> <span class="va">hs</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black   136   40    30</span></span>
<span><span class="co">#&gt;   Brown   238  168   108</span></span>
<span><span class="va">he</span> <span class="op"><a href="../reference/api-pct-operations.html">%a-%</a></span> <span class="va">hs</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black     0    0     0</span></span>
<span><span class="co">#&gt;   Brown     0    0     0</span></span>
<span><span class="va">he</span> <span class="op"><a href="../reference/api-pct-operations.html">%a*%</a></span> <span class="va">hs</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black  4624  400   225</span></span>
<span><span class="co">#&gt;   Brown 14161 7056  2916</span></span>
<span><span class="va">he</span> <span class="op"><a href="../reference/api-pct-operations.html">%a/%</a></span> <span class="va">hs</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black     1    1     1</span></span>
<span><span class="co">#&gt;   Brown     1    1     1</span></span>
<span><span class="va">he</span> <span class="op"><a href="../reference/api-pct-operations.html">%a/0%</a></span> <span class="va">hs</span> <span class="co">## Convention 0/0 = 0</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black     1    1     1</span></span>
<span><span class="co">#&gt;   Brown     1    1     1</span></span></code></pre></div>
<p>Multiplication and addition of (a list of) multiple arrays is
accomplished with tabProd() and tabSum() (much like prod() and
sum()):</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">es</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-tabX.html">tabMarg</a></span><span class="op">(</span><span class="va">hec</span>, <span class="op">~</span><span class="va">Eye</span><span class="op">:</span><span class="va">Sex</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabSum</a></span><span class="op">(</span><span class="va">he</span>, <span class="va">hs</span>, <span class="va">es</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; , , Sex = Male</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black   221  101    65</span></span>
<span><span class="co">#&gt;   Brown   323  229   143</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , Sex = Female</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black   238   83    64</span></span>
<span><span class="co">#&gt;   Brown   340  211   142</span></span>
<span><span class="co">## tabSum(list(he, hs, es))</span></span></code></pre></div>
<p>Lists of arrays are processed with</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api-tabX.html">tabListAdd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">he</span>, <span class="va">hs</span>, <span class="va">es</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; , , Sex = Male</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black   221  101    65</span></span>
<span><span class="co">#&gt;   Brown   323  229   143</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , Sex = Female</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black   238   83    64</span></span>
<span><span class="co">#&gt;   Brown   340  211   142</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabListMult</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">he</span>, <span class="va">hs</span>, <span class="va">es</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; , , Sex = Male</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair      Brown   Blue  Hazel</span></span>
<span><span class="co">#&gt;   Black  393040  24400   7875</span></span>
<span><span class="co">#&gt;   Brown 1203685 430416 102060</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , Sex = Female</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair      Brown   Blue Hazel</span></span>
<span><span class="co">#&gt;   Black  471648  17200  7650</span></span>
<span><span class="co">#&gt;   Brown 1444422 303408 99144</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="an-array-as-a-probability-density---tabdist">An array as a probability density - tabDist()<a class="anchor" aria-label="anchor" href="#an-array-as-a-probability-density---tabdist"></a>
</h3>
<p>If an array consists of non–negative numbers then it may be regarded
as an (unnormalized) discrete multivariate density. With this view, the
following examples should be self explanatory:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api-tabDist.html">tabDist</a></span><span class="op">(</span><span class="va">hec</span>, marg<span class="op">=</span><span class="op">~</span><span class="va">Hair</span><span class="op">:</span><span class="va">Eye</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown   Blue  Hazel</span></span>
<span><span class="co">#&gt;   Black 0.189 0.0556 0.0417</span></span>
<span><span class="co">#&gt;   Brown 0.331 0.2333 0.1500</span></span>
<span><span class="fu"><a href="../reference/api-tabDist.html">tabDist</a></span><span class="op">(</span><span class="va">hec</span>, cond<span class="op">=</span><span class="op">~</span><span class="va">Sex</span><span class="op">)</span> </span>
<span><span class="co">#&gt; , , Sex = Male</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown   Blue  Hazel</span></span>
<span><span class="co">#&gt;   Black 0.177 0.0608 0.0552</span></span>
<span><span class="co">#&gt;   Brown 0.293 0.2762 0.1381</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , Sex = Female</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown   Blue  Hazel</span></span>
<span><span class="co">#&gt;   Black 0.201 0.0503 0.0279</span></span>
<span><span class="co">#&gt;   Brown 0.369 0.1899 0.1620</span></span>
<span><span class="fu"><a href="../reference/api-tabDist.html">tabDist</a></span><span class="op">(</span><span class="va">hec</span>, marg<span class="op">=</span><span class="op">~</span><span class="va">Hair</span>, cond<span class="op">=</span><span class="op">~</span><span class="va">Sex</span><span class="op">)</span> </span>
<span><span class="co">#&gt;        Sex</span></span>
<span><span class="co">#&gt; Hair     Male Female</span></span>
<span><span class="co">#&gt;   Black 0.293  0.279</span></span>
<span><span class="co">#&gt;   Brown 0.707  0.721</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="miscellaneous---tabslicemult">Miscellaneous - tabSliceMult()<a class="anchor" aria-label="anchor" href="#miscellaneous---tabslicemult"></a>
</h3>
<p>Multiply values in a slice by some number and all other values by
another number:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api_tabSlice.html">tabSliceMult</a></span><span class="op">(</span><span class="va">es</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Sex<span class="op">=</span><span class="st">"Female"</span><span class="op">)</span>, val<span class="op">=</span><span class="fl">10</span>, comp<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Sex</span></span>
<span><span class="co">#&gt; Eye     Male Female</span></span>
<span><span class="co">#&gt;   Brown    0   1020</span></span>
<span><span class="co">#&gt;   Blue     0    430</span></span>
<span><span class="co">#&gt;   Hazel    0    340</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="a-bayesian-network">A Bayesian network<a class="anchor" aria-label="anchor" href="#a-bayesian-network"></a>
</h3>
A classical example of a Bayesian network is the ``sprinkler example’’,
see e.g.<br>
(<a href="https://en.wikipedia.org/wiki/Bayesian_network" class="external-link uri">https://en.wikipedia.org/wiki/Bayesian_network</a>):
<p>We specify conditional probabilities <span class="math inline">\(p(r)\)</span>, <span class="math inline">\(p(s|r)\)</span> and <span class="math inline">\(p(w|s,r)\)</span> as follows (notice that the
vertical conditioning bar (<span class="math inline">\(|\)</span>) is
indicated by the horizontal underscore:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">yn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y"</span>,<span class="st">"n"</span><span class="op">)</span></span>
<span><span class="va">lev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rain<span class="op">=</span><span class="va">yn</span>, sprinkler<span class="op">=</span><span class="va">yn</span>, wet<span class="op">=</span><span class="va">yn</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-tabNew.html">tabNew</a></span><span class="op">(</span><span class="op">~</span><span class="va">rain</span>, levels<span class="op">=</span><span class="va">lev</span>, values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">s_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-tabNew.html">tabNew</a></span><span class="op">(</span><span class="op">~</span><span class="va">sprinkler</span><span class="op">:</span><span class="va">rain</span>, levels <span class="op">=</span> <span class="va">lev</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.01</span>, <span class="fl">.99</span>, <span class="fl">.4</span>, <span class="fl">.6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">w_sr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-tabNew.html">tabNew</a></span><span class="op">(</span> <span class="op">~</span><span class="va">wet</span><span class="op">:</span><span class="va">sprinkler</span><span class="op">:</span><span class="va">rain</span>, levels<span class="op">=</span><span class="va">lev</span>, </span>
<span>             values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.99</span>, <span class="fl">.01</span>, <span class="fl">.8</span>, <span class="fl">.2</span>, <span class="fl">.9</span>, <span class="fl">.1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">r</span> </span>
<span><span class="co">#&gt; rain</span></span>
<span><span class="co">#&gt;   y   n </span></span>
<span><span class="co">#&gt; 0.2 0.8</span></span>
<span><span class="va">s_r</span>  <span class="op">|&gt;</span> <span class="fu">flat</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   sprinkler rain Freq</span></span>
<span><span class="co">#&gt; 1         y    y 0.01</span></span>
<span><span class="co">#&gt; 2         n    y 0.99</span></span>
<span><span class="co">#&gt; 3         y    n 0.40</span></span>
<span><span class="co">#&gt; 4         n    n 0.60</span></span>
<span><span class="va">w_sr</span> <span class="op">|&gt;</span> <span class="fu">flat</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   wet sprinkler rain Freq</span></span>
<span><span class="co">#&gt; 1   y         y    y 0.99</span></span>
<span><span class="co">#&gt; 2   n         y    y 0.01</span></span>
<span><span class="co">#&gt; 3   y         n    y 0.80</span></span>
<span><span class="co">#&gt; 4   n         n    y 0.20</span></span></code></pre></div>
<p>The joint distribution <span class="math inline">\(p(r,s,w)=p(r)p(s|r)p(w|s,r)\)</span> can be
obtained with tabProd():</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">joint</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-tabX.html">tabProd</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">s_r</span>, <span class="va">w_sr</span><span class="op">)</span>; <span class="va">joint</span> <span class="op">|&gt;</span> <span class="fu">flat</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   wet sprinkler rain    Freq</span></span>
<span><span class="co">#&gt; 1   y         y    y 0.00198</span></span>
<span><span class="co">#&gt; 2   n         y    y 0.00002</span></span>
<span><span class="co">#&gt; 3   y         n    y 0.15840</span></span>
<span><span class="co">#&gt; 4   n         n    y 0.03960</span></span></code></pre></div>
<p>What is the probability that it rains given that the grass is wet? We
find <span class="math inline">\(p(r,w)=\sum_s p(r,s,w)\)</span> and
then <span class="math inline">\(p(r|w)=p(r,w)/p(w)\)</span>. Can be
done in various ways: with tabDist():</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api-tabDist.html">tabDist</a></span><span class="op">(</span><span class="va">joint</span>, marg<span class="op">=</span><span class="op">~</span><span class="va">rain</span>, cond<span class="op">=</span><span class="op">~</span><span class="va">wet</span><span class="op">)</span></span>
<span><span class="co">#&gt;     wet</span></span>
<span><span class="co">#&gt; rain     y      n</span></span>
<span><span class="co">#&gt;    y 0.358 0.0718</span></span>
<span><span class="co">#&gt;    n 0.642 0.9282</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Alternative:</span></span>
<span><span class="va">rw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-tabX.html">tabMarg</a></span><span class="op">(</span><span class="va">joint</span>, <span class="op">~</span><span class="va">rain</span> <span class="op">+</span> <span class="va">wet</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/api-tabX.html">tabDiv</a></span><span class="op">(</span><span class="va">rw</span>, <span class="fu"><a href="../reference/api-tabX.html">tabMarg</a></span><span class="op">(</span><span class="va">rw</span>, <span class="op">~</span><span class="va">wet</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## or</span></span>
<span><span class="va">rw</span> <span class="op"><a href="../reference/api-pct-operations.html">%a/%</a></span> <span class="op">(</span><span class="va">rw</span> <span class="op"><a href="../reference/api-pct-operations.html">%a_%</a></span> <span class="op">~</span><span class="va">wet</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Alternative:</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api_tabSlice.html">tabSliceMult</a></span><span class="op">(</span><span class="va">rw</span>, slice<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>wet<span class="op">=</span><span class="st">"y"</span><span class="op">)</span><span class="op">)</span>; <span class="va">x</span></span>
<span><span class="co">#&gt;     wet</span></span>
<span><span class="co">#&gt; rain     y n</span></span>
<span><span class="co">#&gt;    y 0.160 0</span></span>
<span><span class="co">#&gt;    n 0.288 0</span></span>
<span><span class="fu"><a href="../reference/api-tabDist.html">tabDist</a></span><span class="op">(</span><span class="va">x</span>, marg<span class="op">=</span><span class="op">~</span><span class="va">rain</span><span class="op">)</span></span>
<span><span class="co">#&gt; rain</span></span>
<span><span class="co">#&gt;     y     n </span></span>
<span><span class="co">#&gt; 0.358 0.642</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="iterative-proportional-scaling-ips">Iterative Proportional Scaling (IPS)<a class="anchor" aria-label="anchor" href="#iterative-proportional-scaling-ips"></a>
</h3>
<p>We consider the <span class="math inline">\(3\)</span>–way data from
:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">lizard</span>, package<span class="op">=</span><span class="st">"gRbase"</span><span class="op">)</span></span>
<span><span class="va">lizard</span> <span class="op">|&gt;</span> <span class="fu">flat</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   diam height species Freq</span></span>
<span><span class="co">#&gt; 1  &lt;=4  &gt;4.75   anoli   32</span></span>
<span><span class="co">#&gt; 2   &gt;4  &gt;4.75   anoli   11</span></span>
<span><span class="co">#&gt; 3  &lt;=4 &lt;=4.75   anoli   86</span></span>
<span><span class="co">#&gt; 4   &gt;4 &lt;=4.75   anoli   35</span></span></code></pre></div>
Consider the two factor log–linear model for the data. Under the model
the expected counts have the form <span class="math display">\[
  \log m(d,h,s)= a_1(d,h)+a_2(d,s)+a_3(h,s)
\]</span> If we let <span class="math inline">\(n(d,h,s)\)</span> denote
the observed counts, the likelihood equations are: Find <span class="math inline">\(m(d,h,s)\)</span> such that
<span class="math display">\[\begin{aligned}
  m(d,h)=n(d,h), \quad
  m(d,s)=n(d,s), \quad
  m(h,s)=n(h,s)
\end{aligned}\]</span>
<p>where <span class="math inline">\(m(d,h)=\sum_s m(d,h.s)\)</span>
etc. The updates are as follows: For the first term we have</p>
<p><span class="math display">\[
m(d,h,s) \leftarrow m(d,h,s) \frac{n(d,h)}{m(d,h)}
%  , \mbox{ where }
%  m(d,h) = \sum_s m(d,h,s)
\]</span></p>
<p>After iterating the updates will not change and we will have
equality: $ m(d,h,s) = m(d,h,s) $ and summing over <span class="math inline">\(s\)</span> shows that the equation <span class="math inline">\(m(d,h)=n(d,h)\)</span> is satisfied.</p>
<p>A rudimentary implementation of iterative proportional scaling for
log–linear models is straight forward:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myips</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">indata</span>, <span class="va">glist</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">fit</span>   <span class="op">&lt;-</span> <span class="va">indata</span></span>
<span>    <span class="va">fit</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="fl">1</span></span>
<span>    <span class="co">## List of sufficient marginal tables</span></span>
<span>    <span class="va">md</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">glist</span>, <span class="kw">function</span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="fu"><a href="../reference/api-tabX.html">tabMarg</a></span><span class="op">(</span><span class="va">indata</span>, <span class="va">g</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">n_iter</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span>    <span class="va">n_generators</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">glist</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_iter</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_generators</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="va">mf</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-tabX.html">tabMarg</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">glist</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>            <span class="co"># adj &lt;- tabDiv( md[[ j ]], mf)</span></span>
<span>            <span class="co"># fit &lt;- tabMult( fit, adj )</span></span>
<span>            <span class="co">## or</span></span>
<span>            <span class="va">adj</span> <span class="op">&lt;-</span> <span class="va">md</span><span class="op">[[</span> <span class="va">j</span> <span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/api-pct-operations.html">%a/%</a></span> <span class="va">mf</span></span>
<span>            <span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">fit</span> <span class="op"><a href="../reference/api-pct-operations.html">%a*%</a></span> <span class="va">adj</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">pearson</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">fit</span> <span class="op">-</span> <span class="va">indata</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">fit</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pearson<span class="op">=</span><span class="va">pearson</span>, fit<span class="op">=</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">glist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species"</span>, <span class="st">"diam"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species"</span>, <span class="st">"height"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"diam"</span>, <span class="st">"height"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu">myips</span><span class="op">(</span><span class="va">lizard</span>, <span class="va">glist</span><span class="op">)</span></span>
<span><span class="va">fm1</span><span class="op">$</span><span class="va">pearson</span></span>
<span><span class="co">#&gt; [1] 665</span></span>
<span><span class="va">fm1</span><span class="op">$</span><span class="va">fit</span> <span class="op">|&gt;</span> <span class="fu">flat</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   species diam height Freq</span></span>
<span><span class="co">#&gt; 1   anoli  &lt;=4  &gt;4.75 32.8</span></span>
<span><span class="co">#&gt; 2    dist  &lt;=4  &gt;4.75 60.2</span></span>
<span><span class="co">#&gt; 3   anoli   &gt;4  &gt;4.75 10.2</span></span>
<span><span class="co">#&gt; 4    dist   &gt;4  &gt;4.75 41.8</span></span>
<span></span>
<span><span class="va">fm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/loglin.html" class="external-link">loglin</a></span><span class="op">(</span><span class="va">lizard</span>, <span class="va">glist</span>, fit<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; 4 iterations: deviation 0.00962</span></span>
<span><span class="va">fm2</span><span class="op">$</span><span class="va">pearson</span></span>
<span><span class="co">#&gt; [1] 0.151</span></span>
<span><span class="va">fm2</span><span class="op">$</span><span class="va">fit</span> <span class="op">|&gt;</span> <span class="fu">flat</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   diam height species Freq</span></span>
<span><span class="co">#&gt; 1  &lt;=4  &gt;4.75   anoli 32.8</span></span>
<span><span class="co">#&gt; 2   &gt;4  &gt;4.75   anoli 10.2</span></span>
<span><span class="co">#&gt; 3  &lt;=4 &lt;=4.75   anoli 85.2</span></span>
<span><span class="co">#&gt; 4   &gt;4 &lt;=4.75   anoli 35.8</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="some-low-level-functions">Some low level functions<a class="anchor" aria-label="anchor" href="#some-low-level-functions"></a>
</h2>
<p>For e.g. a <span class="math inline">\(2\times 3 \times 2\)</span>
array, the entries are such that the first variable varies fastest so
the ordering of the cells are <span class="math inline">\((1,1,1)\)</span>, <span class="math inline">\((2,1,1)\)</span>, <span class="math inline">\((1,2,1)\)</span>, <span class="math inline">\((2,2,1)\)</span>, <span class="math inline">\((1,3,1)\)</span> and so on. To find the value of
such a cell, say, <span class="math inline">\((j,k,l)\)</span> in the
array (which is really just a vector), the cell is mapped into an entry
of a vector.</p>
<p>For example, cell <span class="math inline">\((2,3,1)\)</span>
(Hair=Brown, Eye=Hazel, Sex=Male) must be mapped to entry <span class="math inline">\(4\)</span> in</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hec</span></span>
<span><span class="co">#&gt; , , Sex = Male</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    32   11    10</span></span>
<span><span class="co">#&gt;   Brown    53   50    25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , Sex = Female</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    36    9     5</span></span>
<span><span class="co">#&gt;   Brown    66   34    29</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">hec</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 32 53 11 50 10 25 36 66  9 34  5 29</span></span></code></pre></div>
<p>For illustration we do:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cell2name</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">cell</span>, <span class="va">dimnames</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span>,</span>
<span>                  <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">{</span></span>
<span>                      <span class="va">dimnames</span><span class="op">[[</span><span class="va">m</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">cell</span><span class="op">[</span><span class="va">m</span><span class="op">]</span><span class="op">]</span></span>
<span>                  <span class="op">}</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="fu">cell2name</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">hec</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Brown" "Hazel" "Male"</span></span></code></pre></div>
<div class="section level3">
<h3 id="cell2entry-and-entry2cell">cell2entry and entry2cell<a class="anchor" aria-label="anchor" href="#cell2entry-and-entry2cell"></a>
</h3>
<p>The map from a cell to the corresponding entry is provided by . The
reverse operation, going from an entry to a cell (which is much less
needed) is provided by .</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api-cell.html">cell2entry</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="fu"><a href="../reference/api-cell.html">entry2cell</a></span><span class="op">(</span><span class="fl">6</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2 3 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="next_cell">next_cell()<a class="anchor" aria-label="anchor" href="#next_cell"></a>
</h3>
<p>Given a cell, say <span class="math inline">\(i=(2,3,1)\)</span> in a
<span class="math inline">\(2\times 3\times 2\)</span> array we often
want to find the next cell in the table following the convention that
the first factor varies fastest, that is <span class="math inline">\((1,1,2)\)</span>. This is provided by
next_cell().</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api-cell.html">next_cell</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 1 2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="next_cell_slice-and-slice2entry">next_cell_slice() and slice2entry()<a class="anchor" aria-label="anchor" href="#next_cell_slice-and-slice2entry"></a>
</h3>
<p>Given that we look at cells for which for which the index in
dimension <span class="math inline">\(2\)</span> is at level <span class="math inline">\(3\)</span> (that is Eye=Hazel), i.e. cells of the
form <span class="math inline">\((j,3,l)\)</span>. Given such a cell,
what is then the next cell that also satisfies this constraint. This is
provided by next_cell_slice().
<!-- \footnote{FIXME: sliceset should be called margin.} --></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api-cell.html">next_cell_slice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>, slice_marg<span class="op">=</span><span class="fl">2</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2 3 1</span></span>
<span><span class="fu"><a href="../reference/api-cell.html">next_cell_slice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>, slice_marg<span class="op">=</span><span class="fl">2</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 3 2</span></span></code></pre></div>
<p>Given that in dimension <span class="math inline">\(2\)</span> we
look at level <span class="math inline">\(3\)</span>. We want to find
entries for the cells of the form <span class="math inline">\((j,3,l)\)</span>.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api-cell.html">slice2entry</a></span><span class="op">(</span>slice_cell<span class="op">=</span><span class="fl">3</span>, slice_marg<span class="op">=</span><span class="fl">2</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  5  6 11 12</span></span></code></pre></div>
<p>To verify that we indeed get the right cells:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api-cell.html">slice2entry</a></span><span class="op">(</span>slice_cell<span class="op">=</span><span class="fl">3</span>, slice_marg<span class="op">=</span><span class="fl">2</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">entry2cell</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span> <span class="op">)</span><span class="op">)</span>,</span>
<span>       <span class="va">cell2name</span>, <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">hec</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] "Black" "Hazel" "Male" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] "Brown" "Hazel" "Male" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] "Black"  "Hazel"  "Female"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] "Brown"  "Hazel"  "Female"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fact_grid---factorial-grid">fact_grid() - factorial grid<a class="anchor" aria-label="anchor" href="#fact_grid---factorial-grid"></a>
</h3>
<p>Using the operations above we can obtain the combinations of the
factors as a matrix:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span> <span class="fu"><a href="../reference/api-cell.html">fact_grid</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">)</span>, <span class="fl">6</span> <span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    1    1    1</span></span>
<span><span class="co">#&gt; [2,]    2    1    1</span></span>
<span><span class="co">#&gt; [3,]    1    2    1</span></span>
<span><span class="co">#&gt; [4,]    2    2    1</span></span>
<span><span class="co">#&gt; [5,]    1    3    1</span></span>
<span><span class="co">#&gt; [6,]    2    3    1</span></span></code></pre></div>
<p>A similar dataframe can also be obtained with the standard R function
(but is faster)</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, <span class="fl">6</span> <span class="op">)</span></span>
<span><span class="co">#&gt;   Var1 Var2 Var3</span></span>
<span><span class="co">#&gt; 1    1    1    1</span></span>
<span><span class="co">#&gt; 2    2    1    1</span></span>
<span><span class="co">#&gt; 3    1    2    1</span></span>
<span><span class="co">#&gt; 4    2    2    1</span></span>
<span><span class="co">#&gt; 5    1    3    1</span></span>
<span><span class="co">#&gt; 6    2    3    1</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="more-about-slicing">More about slicing<a class="anchor" aria-label="anchor" href="#more-about-slicing"></a>
</h2>
<p>Slicing using standard R code can be done as follows:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hec</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span>  <span class="op">|&gt;</span> <span class="fu">flat</span><span class="op">(</span><span class="op">)</span>  <span class="co">## A 2 x 2 x 2 array</span></span>
<span><span class="co">#&gt;    Hair   Eye  Sex Freq</span></span>
<span><span class="co">#&gt; 1 Black  Blue Male   11</span></span>
<span><span class="co">#&gt; 2 Brown  Blue Male   50</span></span>
<span><span class="co">#&gt; 3 Black Hazel Male   10</span></span>
<span><span class="co">#&gt; 4 Brown Hazel Male   25</span></span>
<span><span class="va">hec</span><span class="op">[</span><span class="fl">1</span>, , <span class="fl">1</span><span class="op">]</span>             <span class="co">## A vector</span></span>
<span><span class="co">#&gt; Brown  Blue Hazel </span></span>
<span><span class="co">#&gt;    32    11    10</span></span>
<span><span class="va">hec</span><span class="op">[</span><span class="fl">1</span>, , <span class="fl">1</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span> <span class="co">## A 1 x 3 x 1 array</span></span>
<span><span class="co">#&gt; , , Sex = Male</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    32   11    10</span></span></code></pre></div>
<p>Programmatically we can do the above as</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"["</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">hec</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu">flat</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Hair   Eye  Sex Freq</span></span>
<span><span class="co">#&gt; 1 Black  Blue Male   11</span></span>
<span><span class="co">#&gt; 2 Brown  Blue Male   50</span></span>
<span><span class="co">#&gt; 3 Black Hazel Male   10</span></span>
<span><span class="co">#&gt; 4 Brown Hazel Male   25</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"["</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">hec</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">TRUE</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Brown  Blue Hazel </span></span>
<span><span class="co">#&gt;    32    11    10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"["</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">hec</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">TRUE</span>, <span class="fl">1</span><span class="op">)</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt; , , Sex = Male</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    32   11    10</span></span></code></pre></div>
<p> provides two alterntives for each of these three cases above:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/api_tabSlice.html">tabSlicePrim</a></span><span class="op">(</span><span class="va">hec</span>, slice<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu">flat</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Hair   Eye  Sex Freq</span></span>
<span><span class="co">#&gt; 1 Black  Blue Male   11</span></span>
<span><span class="co">#&gt; 2 Brown  Blue Male   50</span></span>
<span><span class="co">#&gt; 3 Black Hazel Male   10</span></span>
<span><span class="co">#&gt; 4 Brown Hazel Male   25</span></span>
<span><span class="fu"><a href="../reference/api_tabSlice.html">tabSlice</a></span><span class="op">(</span><span class="va">hec</span>, slice<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, margin<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">flat</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Hair   Eye  Sex Freq</span></span>
<span><span class="co">#&gt; 1 Black  Blue Male   11</span></span>
<span><span class="co">#&gt; 2 Brown  Blue Male   50</span></span>
<span><span class="co">#&gt; 3 Black Hazel Male   10</span></span>
<span><span class="co">#&gt; 4 Brown Hazel Male   25</span></span>
<span></span>
<span><span class="fu"><a href="../reference/api_tabSlice.html">tabSlicePrim</a></span><span class="op">(</span><span class="va">hec</span>, slice<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">TRUE</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; Brown  Blue Hazel </span></span>
<span><span class="co">#&gt;    32    11    10</span></span>
<span><span class="fu"><a href="../reference/api_tabSlice.html">tabSlice</a></span><span class="op">(</span><span class="va">hec</span>, slice<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, margin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Brown  Blue Hazel </span></span>
<span><span class="co">#&gt;    32    11    10</span></span>
<span></span>
<span><span class="fu"><a href="../reference/api_tabSlice.html">tabSlicePrim</a></span><span class="op">(</span><span class="va">hec</span>, slice<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">TRUE</span>, <span class="fl">1</span><span class="op">)</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; , , Sex = Male</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    32   11    10</span></span>
<span><span class="fu"><a href="../reference/api_tabSlice.html">tabSlice</a></span><span class="op">(</span><span class="va">hec</span>, slice<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, margin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="co">#&gt; , , Sex = Male</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel</span></span>
<span><span class="co">#&gt;   Black    32   11    10</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Søren Højsgaard.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
